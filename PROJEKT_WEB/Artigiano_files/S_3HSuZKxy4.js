/*!CK:606630754!*//*1452531887,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["w227Z"]); }

__d('CalendarHomepageReminders',['Arbiter','UIPagelet','emptyFunction','ge'],function a(b,c,d,e,f,g,h,i,j,k){'use strict';if(c.__markCompiled)c.__markCompiled();var l='EVENT_ACTION',m={register:function(){h.subscribe(l,function(){if(k('pagelet_reminders'))i.loadFromEndpoint('RemindersPagelet','pagelet_reminders');});m.register=j;}};f.exports=m;},null);
__d("XEventReminderImpressionLoggerAsyncController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/events\/ajax\/reminder\/impression\/",{acontext:{type:"StringToStringMap",required:true},data:{type:"StringToStringMap"}});},null);
__d('EventReminderController',['Arbiter','AsyncRequest','DOM','DOMQuery','Event','Scroll','ScrollableArea','XEventReminderImpressionLoggerAsyncController'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p={registerReminder:function(q,r){this._firstOpen=true;var s=q.getDialog(),t=n.getInstance(k.scry(s.getRoot(),'.uiScrollableArea')[0]),u=null;if(t){u=j.find(t.getElement(),'div.uiScrollableAreaWrap');t.subscribe('scroll',function(){return (h.inform('EventReminderDialog/scroll',{rect:u.getBoundingClientRect(),scrollTop:m.getTop(u)}));});}l.listen(q.getRoot(),'click',function(event){event.preventDefault();});s.subscribe('show',(function(){var v=o.getURIBuilder().setStringToStringMap('acontext',r).setStringToStringMap('data',{first_open:this._firstOpen}).getURI();new i(v).send();this._firstOpen=false;var w={};if(u)w={rect:u.getBoundingClientRect()};h.inform('EventReminderDialog/show',w);}).bind(this));s.subscribe('hide',function(){return h.inform('EventReminderDialog/hide');});}};f.exports=p;},null);
__d('FlexibleScrollableArea',['DataStore','DOM','DOMDimensions','Event','Parent','Run','Style','Vector','throttle'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q=30,r=100;function s(t,u,v,w,x){'use strict';this._element=t;this._tight=u;this._measureFrom=v;this._minHeight=w;this._margin=x;h.set(this._element,'FlexibleScrollableArea',this);m.onLeave(this.cleanup.bind(this));this._listener=k.listen(window,'resize',p(this.poke,r,this));this.poke();}s.prototype.poke=function(){'use strict';var t=i.find(this._element,'.uiScrollableAreaBody'),u=o.getElementDimensions(t).y+j.measureElementBox(t,'height',true,true,true),v;if(this._tight){var w=this.getMaxHeight();if(u<w+q)w+=q;v=Math.max(Math.min(u,w),this._minHeight);}else v=Math.max(this.getMaxHeight(),this._minHeight);n.set(this._element,'height',v+'px');};s.prototype.getMaxHeight=function(){'use strict';if(this._measureFrom==='bottom'){var t=o.getViewportDimensions().y,u=o.getElementPosition(this._element,'viewport').y,v=t-u;return v-this._margin;}var w=o.getElementPosition(this._element,'viewport').y+o.getElementDimensions(this._element).y;return w-this._margin;};s.prototype.cleanup=function(){'use strict';this._listener&&this._listener.remove();};s.getInstance=function(t){'use strict';var u=l.byClass(t,'flexibleScrollableArea');return u?h.get(u,'FlexibleScrollableArea'):null;};f.exports=s;},null);
__d('LoadRecommendations',['Event','AsyncRequest'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={loadOnClick:function(k){h.listen(k,'click',function(){new i().setURI('/ajax/pages/reminder/recommendations').send();});}};f.exports=j;},null);
__d('ReminderStory',['AsyncRequest','Arbiter','DOMQuery','Event','FlexibleScrollableArea','LayerAutoFocus','ScrollableArea','SubscriptionsHandler','UIPagelet','getActiveElement'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();function r(s,t,u,v,w,x){'use strict';this.$ReminderStory1=false;this.$ReminderStory2=t;this.$ReminderStory3=s;k.listen(s,'click',(function(event){if(u&&j.contains(u,event.target))return;t.show();if(v)new h('/growth/reminder/logging.php').setData({context_data:v,first_click:!this.$ReminderStory1}).send();this.$ReminderStory1=true;}).bind(this));if(w)t.subscribeOnce('show',function(){p.loadFromEndpoint(w,t.getContent(),x);});t.disableBehavior(m);t.subscribe('aftershow',(function(){var y=t.getRoot(),z=j.scry(y,'#SuggestBelowInvite')[0];if(z)new h('/ajax/pages/reminder/recommendations').send();var aa=t.hide.bind(t);this.$ReminderStory4=new o();this.$ReminderStory4.addSubscriptions(k.listen(window,'resize',aa),k.listen(window,'scroll',aa));var ba=j.scry(y,'.inlineReplyTextArea');ba[0]&&ba[0].focus();var ca=j.scry(y,'.jewelItemNew'),da=[];ca.forEach(function(ha){var ia=ca[ha].getAttribute('id');if(ia&&ia.endsWith('_1_req'))da=da.concat(ia.replace('_1_req',''));});if(da.length>0)new h('/friends/requests/log_impressions').setData({ids:da.join(','),ref:'reminder_box'}).send();var ea=n.getInstance(j.scry(t.getRoot(),'.uiScrollableArea')[0]),fa=l.getInstance(j.scry(t.getRoot(),'.flexibleScrollableArea')[0]),ga=function(){if(fa)fa.poke();if(ea){ea.poke();k.fire(j.scry(t.getRoot(),'.scrollable')[0],'scroll');}};ga();i.subscribe('reflow',function(){var ha=j.scry(y,'.fbRemindersBirthdayList');if(ba&&ha)for(var ia=0;ia<ba.length;++ia)if(ba[ia]==q()&&j.contains(ha[0],ba[ia]))ga();});}).bind(this));t.subscribe('beforehide',(function(){if(this.$ReminderStory4){this.$ReminderStory4.release();this.$ReminderStory4=null;}}).bind(this));}r.prototype.getDialog=function(){'use strict';return this.$ReminderStory2;};r.prototype.getRoot=function(){'use strict';return this.$ReminderStory3;};f.exports=r;},null);