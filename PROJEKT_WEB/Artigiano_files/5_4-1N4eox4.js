/*!CK:3295495453!*//*1453403685,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["Pxy+7"]); }

__d("MessagesViewerSetID",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={MESSAGES:"messages",MESSAGES_VIEW_ALL_IN_THREAD:"messages:view_all_in_thread"};},null);
__d("P2PPaymentLoggerEvent",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={ACTN_ADD_CREDIT_CARD:"Actn_AddCreditCard",ACTN_UPDATE_CREDIT_CARD:"Actn_UpdateCreditCard",ACTN_REMOVE_CREDIT_CARD:"Actn_RemoveCreditCard",ACTN_UNLOCK_CREDIT_CARD:"Actn_UnlockCreditCard",ACTN_VALIDATE_CARD:"Actn_ValidateCard",ACTN_TRANSFER_MONEY:"Actn_TransferMoney",ACTN_TRANSFER_MONEY_WITH_CAMPAIGN:"Actn_TransferMoneyWithCampaign",ACTN_TRANSFER_MONEY_WITH_CAMPAIGN_PARENT_CALL:"Actn_TransferMoneyWithCampaignParentCall",ACTN_TRANSFER_MONEY_WITH_CAMPAIGN_POST_SUCCESS:"Actn_TransferMoneyWithCampaignPostSuccess",ACTN_TRANSFER_MONEY_CHECK_NEEDS_REVERT:"Actn_TransferMoneyCheckNeedsRevert",ACTN_TRANSFER_MONEY_REVERT:"Actn_TransferMoneyRevert",ACTN_TRANSFER_MONEY_CREATE_CONTEXT:"Actn_TransferMoneyCreateContext",ACTN_TRANSFER_MONEY_CREATE_PLATFORM_ITEM:"Actn_TransferMoneyCreatePlatformItem",ACTN_ACCEPT_MONEY:"Actn_AcceptMoney",ACTN_DECLINE_MONEY:"Actn_DeclineMoney",ACTN_SET_PRIMARY:"Actn_SetPrimary",ACTN_WITHDRAW_MONEY:"Actn_WithdrawMoney",ACTN_CREATE_MSGR_COMMERCE_CART:"Actn_CreateMsgrCommerceCart",ACTN_PLACE_MSGR_COMMERCE_ORDER:"Actn_PlaceMsgrCommerceOrder",ACTN_GRAPH_API_GENERIC_WRITE:"Actn_GraphApiGenericWrite",ACTN_SEND_TRANSFER_MESSAGE:"Actn_SendTransferMessage",ACTN_SEND_TRANSFER_EMAIL:"Actn_SendTransferEmail",ACTN_SEND_EXPIRE_NOTIFICATIONS:"Actn_SendExpireNotifications",ACTN_SEND_TRANSFER_MESSAGE_QUEUED:"Actn_SendTransferMessageQueued",ACTN_UNCATEGORIZED_EXCEPTION:"Actn_Uncategorized_Exception",ACTN_INCREASE_CAMPAIGN_COUNTER:"Actn_Increase_Campaign_Counter",ACTN_CREATE_PAYMENT_REQUEST:"Actn_CreatePaymentRequest",ACTN_REMIND_PAYMENT_REQUEST:"Actn_RemindPaymentRequest",ACTN_PAY_PAYMENT_REQUEST:"Actn_PayPaymentRequest",ACTN_DECLINE_PAYMENT_REQUEST:"Actn_DeclinePaymentRequest",ACTN_CANCEL_PAYMENT_REQUEST:"Actn_CancelPaymentRequest",ACTN_EXPIRE_PAYMENT_REQUEST:"Actn_ExpirePaymentRequest",ACTN_SEND_PAYMENT_REQUEST_MESSAGE:"Actn_SendPaymentRequestMessage",ACTN_AUTH_FOR_SENDER_REVIEW:"Actn_AuthForSenderReview",ACTN_COMPLETE_SENDER_REVIEW:"Actn_CompleteSenderReview",ACTN_COMPLETE_RECEIVER_REVIEW:"Actn_CompleteReceiverReview",ACTN_SUBMIT_VERIFICATION_STEP:"Actn_SubmitVerificationStep",ACTN_COMPLETE_SENDER_VERIFICATION:"Actn_CompleteSenderVerification",ACTN_COMPLETE_RECEIVER_VERIFICATION:"Actn_CancelReceiverVerification",ACTN_CANCEL_SENDER_VERIFICATION:"Actn_CancelSenderVerification",ACTN_CANCEL_RECEIVER_VERIFICATION:"Actn_CancelReceiverVerification",ACTN_CANCEL_SENDER_RISK:"Actn_CancelSenderRisk",ACTN_CANCEL_EXPIRE:"Actn_CancelExpire",ACTN_CANCEL_FOR_SAME_CARD:"Actn_CancelForSameCard",ACTN_CANCEL_BY_CUSTOMER_SERVICE:"Actn_CancelByCustomerService",ACTN_CANCEL_RECEIVER_REVIEW:"Actn_CancelReceiverReview",ACTN_CANCEL_SENDER_REVIEW:"Actn_CancelSenderReview",ACTN_CANCEL_ALL_PENDING_TRANSFERS:"Actn_CancelAllPendingTransfers",ACTN_FILTER_LOGMESSAGE:"Actn_FilterLogMessage",ACTN_FILTER_NOTIFICATION:"Actn_FilterNotification",ACTN_ADD_PIN:"Actn_AddPIN",ACTN_UPDATE_PIN:"Actn_UpdatePIN",ACTN_REMOVE_PIN:"Actn_RemovePIN",ACTN_RESET_PIN:"Actn_ResetPIN",ACTN_ENABLE_TOUCH_ID:"Actn_EnableTouchID",ACTN_VERIFY_TOUCH_ID:"Actn_VerifyTouchID",ACTN_DISABLE_TOUCH_ID:"Actn_DisableTouchID",ACTN_CHANNEL_NOTIF_CARD_EVENT:"Actn_ChannelNotifCardEvent",ACTN_CHANNEL_NOTIF_TRANSFER_STATUS_EVENT:"Actn_ChannelNotifTransferStatusEvent",ACTN_CHANNEL_NOTIF_PLATFORM_EVENT:"Actn_ChannelNotifPlatformEvent",ACTN_CHANNEL_NOTIF_PAYMENT_REQUEST_STATUS_EVENT:"Actn_ChannelNotifPaymentRequestStatusEvent",ACTN_PLATFORM_BANNER_DISMISSED:"Actn_PlatformBannerDismissed",ACTN_PLATFORM_BANNER_MARK_AS_SOLD:"Actn_PlatformBannerMarkAsSold",ACTN_ADD_ADDRESS:"Actn_AddAddress",ACTN_GET_ADDRESSES:"Actn_GetAddresses",ACTN_GET_CURRENT_USER_PROFILE_DATA:"Actn_GetCurrentUserProfileData",ACTN_CAMPAIGN_CHECK_USER_HAS_NEW_ACTIVITY:"Actn_CampaignCheckUserHasNewActivity",ACTN_CAMPAIGN_SAVE_PROMO_NOTIFICATION_TIME:"Actn_CampaignSavePromoNotificationTime",UI_ACTN_SEND_MONEY_BUTTON_CLICKED:"UI_Actn_Send_Money_Button_Clicked",UI_ACTN_SEND_MONEY_BUTTON_PLACEHOLDER_CLICKED:"UI_Actn_Send_Money_Button_Placeholder_Clicked",UI_ACTN_INITIATE_SEND:"UI_Actn_Initiate_Send",UI_ACTN_CANCEL_SEND:"UI_Actn_Send_Money_Cancelled",UI_ACTN_INITIATE_ADD_CARD:"UI_Actn_Initiate_Add_Card",UI_ACTN_INITIATE_CHOOSE_CARD:"UI_Actn_Initiate_Choose_Card",UI_ACTN_CANCEL_ADD_CARD:"UI_Actn_Cancel_Add_Card",UI_ACTN_CONFIRM_CARD_DETAILS:"UI_Actn_Confirm_Card_Details",UI_ACTN_ACCEPT_MONEY_CANCEL:"UI_Actn_Accept_Money_Cancel",UI_ACTN_ACCEPT_WITH_CARD:"UI_Actn_Accept_With_Card",UI_ACTN_ADD_CARD_SUCCESS:"UI_Actn_Add_Card_Success",UI_ACTN_ADD_CARD_FAIL:"UI_Actn_Add_Card_Fail",UI_ACTN_CONFIRM_SEND:"UI_Actn_Confirm_Send",UI_ACTN_SEND_SUCCESS:"UI_Actn_Send_Success",UI_ACTN_SEND_MONEY_CANCELLED:"UI_Actn_Send_Money_Cancelled",UI_ACTN_SEND_FAIL:"UI_Actn_Send_Fail",UI_ACTN_INITIATE_EDIT_CARD:"UI_Actn_Initiate_Edit_Card",UI_ACTN_CANCEL_EDIT_CARD:"UI_Actn_Cancel_Edit_Card",UI_ACTN_CONFIRM_EDIT_CARD_DETAILS:"UI_Actn_Confirm_Edit_Card_Details",UI_ACTN_EDIT_CARD_SUCCESS:"UI_Actn_Edit_Card_Success",UI_ACTN_EDIT_CARD_FAIL:"UI_Actn_Edit_Card_Fail",UI_ACTN_INITIATE_REMOVE_CARD:"UI_Actn_Initiate_Remove_Card",UI_ACTN_CONFIRM_REMOVE_CARD:"UI_Actn_Confirm_Remove_Card",UI_ACTN_REMOVE_CARD_SUCCESS:"UI_Actn_Remove_Card_Success",UI_ACTN_REMOVE_CARD_FAIL:"UI_Actn_Remove_Card_Fail",UI_ACTN_INITIATE_PASSWORD_PROTECTION_NUX:"UI_Actn_Initiate_Password_Protection_NUX",UI_ACTN_OPT_IN_PASSWORD_PROTECTION_NUX:"UI_Actn_Opt_In_Password_Protection_NUX",UI_ACTN_OPT_OUT_PASSWORD_PROTECTION_NUX:"UI_Actn_Opt_Out_Password_Protection_NUX",UI_ACTN_ENABLED_PASSWORD_PROTECTION_SETTING:"UI_Actn_Enabled_Password_Protection_Setting",UI_ACTN_DISABLED_PASSWORD_PROTECTION_SETTING:"UI_Actn_Disabled_Password_Protection_Setting",UI_ACTN_SEND_CLICKED:"UI_Actn_Send_Clicked",UI_ACTN_VERIFY_CSC:"UI_Actn_Verify_CSC",UI_ACTN_CONFIRM_AMOUNT:"UI_Actn_Confirm_Amount",UI_ACTN_EDIT_CARD:"UI_Actn_Edit_Card",UI_ACTN_CHANGE_CARD:"UI_Actn_Change_Card",UI_ACTN_INITIATE_SEND_TRIGGER:"UI_Actn_Initiate_Send_Trigger",UI_ACTN_INITIATE_GROUP_SEND:"UI_Actn_Initiate_Group_Send",UI_ACTN_GROUP_SEND_CANCELLED:"UI_Actn_Group_Send_Cancelled",UI_ACTN_INITIATE_GROUP_SEND_TRIGGER:"UI_Actn_Initiate_Group_Send_Trigger",UI_ACTN_GROUP_SEND_RECIPIENT_PICKED:"UI_Actn_Group_Send_Recipient_Picked",UI_ACTN_3RD_PARTY_RECEIPT_SHOWN:"UI_Actn_3rd_Party_Receipt_Shown",UI_ACTN_3RD_PARTY_RECEIPT_DISMISSED:"UI_Actn_3rd_Party_Receipt_Dismissed",UI_ACTN_3RD_PARTY_NON_ENABLED_LOG_MESSAGE_CLICKED:"UI_Actn_3rd_Party_Non_Enabled_Log_Message_Clicked",UI_ACTN_3RD_PARTY_NON_ENABLED_LOG_MESSAGE_CANCELLED:"UI_Actn_3rd_Party_Non_Enabled_Log_Message_Cancelled",UI_ACTN_CHAT_THREAD_BANNER_CLICKED:"UI_Actn_Chat_Thread_Banner_Clicked",UI_ACTN_CHAT_THREAD_BANNER_VIEWED:"UI_Actn_Chat_Thread_Banner_Viewed",UI_ACTN_CHAT_THREAD_BANNER_DISMISSED:"UI_Actn_Chat_Thread_Banner_Dismissed",UI_ACTN_INITIATE_MONEYPENNY_ORDER:"UI_Actn_Initiate_Moneypenny_Order",UI_ACTN_CONFIRM_MONEYPENNY_ORDER:"UI_Actn_Confirm_Moneypenny_Order",UI_ACTN_MONEYPENNY_ORDER_FAIL:"UI_Actn_Moneypenny_Order_Fail",UI_ACTN_MONEYPENNY_ORDER_SUCCESS:"UI_Actn_Moneypenny_Order_Success",UI_ACTN_MONEYPENNY_ORDER_CANCEL:"UI_Actn_Moneypenny_Order_Cancel",UI_ACTN_FRIEND_PICKER_SEARCH:"UI_Actn_Friend_Picker_Search",UI_ACTN_FRIEND_PICKER_SELECT:"UI_Actn_Friend_Picker_Select",UI_ACTN_FI_CANCEL:"UI_Actn_FI_Cancel",UI_ACTN_FI_SUCCESS_DIALOG_NEXT:"UI_Action_Success_Dialog_Next",UI_ACTN_FI_BANNER_DISMISSED:"UI_Actn_FI_Banner_Dismissed",UI_ACTN_FI_BANNER_IMPRESSION:"UI_Actn_FI_Banner_Impression",UI_ACTN_INCENTIVE_TRANSFER_SUCCESS:"UI_Actn_Incentive_Transfer_Success",UI_ACTN_INCENTIVE_TRANSFER_FAILURE:"UI_Actn_Incentive_Transfer_Failure",UI_ACTN_PLATFORM_BANNER_SELLER_HIDE_CLICKED:"UI_Actn_Platform_Banner_Seller_Hide_Clicked",UI_ACTN_PLATFORM_BANNER_BUYER_HIDE_CLICKED:"UI_Actn_Platform_Banner_Buyer_Hide_Clicked",UI_ACTN_PLATFORM_BANNER_SOLD_CLICKED:"UI_Actn_Platform_Banner_Sold_Clicked",UI_ACTN_PLATFORM_BANNER_IMAGE_CLICKED:"UI_Actn_Platform_Banner_Image_Clicked",UI_ACTN_PLATFORM_BANNER_TITLE_CLICKED:"UI_Actn_Platform_Banner_Title_Clicked",UI_ACTN_PLATFORM_BANNER_PAY_CLICKED:"UI_Actn_Platform_Banner_Pay_Clicked",UI_ACTN_PLATFORM_BANNER_SELLER_VIEWED:"UI_Actn_Platform_Banner_Seller_Viewed",UI_ACTN_PLATFORM_BANNER_BUYER_VIEWED:"UI_Actn_Platform_Banner_Buyer_Viewed",UI_ACTN_PLATFORM_BANNER_PAY_NUX_SHOWN:"UI_Actn_Platform_Banner_Pay_Nux_Shown",UI_ACTN_INITIATE_REQUEST:"UI_Actn_Initiate_Request",UI_ACTN_REQUEST_CLICKED:"UI_Actn_Request_Clicked",UI_ACTN_CONFIRM_REQUEST:"UI_Actn_Confirm_Request",UI_ACTN_REQUEST_SUCCESS:"UI_Actn_Request_Success",UI_ACTN_REQUEST_FAIL:"UI_Actn_Request_Fail",UI_ACTN_INITIATE_DECLINE_REQUEST:"UI_Actn_Initiate_Decline_Request",UI_ACTN_CONFIRM_DECLINE_REQUEST:"UI_Actn_Confirm_Decline_Request",UI_ACTN_DECLINE_REQUEST_FAIL:"UI_Actn_Decline_Request_Fail",UI_ACTN_DECLINE_REQUEST_SUCCESS:"UI_Actn_Decline_Request_Success",UI_ACTN_INITIATE_CANCEL_REQUEST:"UI_Actn_Initiate_Cancel_Request",UI_ACTN_CONFIRM_CANCEL_REQUEST:"UI_Actn_Confirm_Cancel_Request",UI_ACTN_CANCEL_REQUEST_FAIL:"UI_Actn_Cancel_Request_Fail",UI_ACTN_CANCEL_REQUEST_SUCCESS:"UI_Actn_Cancel_Request_Success",UI_ACTN_INITIATE_CHECKOUT:"UI_Actn_Initiate_Checkout",UI_ACTN_CHECKOUT_CONFIRM:"UI_Actn_Checkout_Confirm",UI_ACTN_INITIATE_ADD_ADDRESS:"UI_Actn_Initiate_Add_Address",UI_ACTN_CANCEL_ADD_ADDRESS:"UI_Actn_Cancel_Add_Address",UI_ACTN_INITIATE_CHOOSE_ADDRESS:"UI_Actn_Initiate_Choose_Address",UI_ACTN_CONFIRM_ADDRESS_DETAILS:"UI_Actn_Confirm_Address_Details",UI_ACTN_ADD_ADDRESS_SUCCESS:"UI_Actn_Add_Address_Success",UI_ACTN_ADD_ADDRESS_FAIL:"UI_Actn_Add_Address_Fail",UI_ACTN_CHECKOUT_FAIL:"UI_Actn_Checkout_Fail",UI_ACTN_CHECKOUT_CART_CREATION_FAIL:"UI_Actn_Checkout_Cart_Creation_Fail",UI_ACTN_CHECKOUT_CANCEL:"UI_Actn_Checkout_Cancel",UI_ACTN_CHECKOUT_SUCCESS:"UI_Actn_Checkout_Success",UI_ACTN_CHECKOUT_CART_CREATION_SUCCESS:"UI_Actn_Checkout_Cart_Creation_Success",UI_ACTN_SEND_MONEY_PAGE_VIEWED:"UI_Actn_Send_Money_Page_Viewed",UI_ACTN_ACCEPT_MONEY_NUX_SHOWN:"UI_Actn_Accept_Money_NUX_Shown",UI_ACTN_ACCEPT_MONEY_NUX_NEXT_CLICK:"UI_Actn_Accept_Money_NUX_Next_Click",UI_ACTN_SEND_MONEY_NUX_SHOWN:"UI_Actn_Send_Money_NUX_Shown",UI_ACTN_SEND_MONEY_NUX_NEXT_CLICK:"UI_Actn_Send_Money_NUX_Next_Click",UI_ACTN_GET_CREDIT_CARDS_EXCEPTION:"UI_ACTN_GET_CREDIT_CARDS_EXCEPTION",UI_ACTN_CREATE_TRANSFER_EXCEPTION:"UI_ACTN_CREATE_TRANSFER_EXCEPTION",UI_ACTN_ADD_CARD_EXCEPTION:"UI_ACTN_ADD_CARD_EXCEPTION",UI_ACTN_GET_TRANSFERS_EXCEPTION:"UI_ACTN_GET_TRANSFERS_EXCEPTION",UI_ACTN_GET_EXTENSIVE_TRANSFERS_EXCEPTION:"UI_ACTN_GET_EXTENSIVE_TRANSFERS_EXCEPTION",UI_ACTN_GET_NUX_TRANSFERS_EXCEPTION:"UI_ACTN_GET_NUX_TRANSFERS_EXCEPTION",UI_ACTN_UPDATE_PRESET_CARD_EXCEPTION:"UI_ACTN_UPDATE_PRESET_CARD_EXCEPTION",UI_ACTN_UPDATE_CARD_EXCEPTION:"UI_ACTN_UPDATE_CARD_EXCEPTION",UI_ACTN_DELETE_CARD_EXCEPTION:"UI_ACTN_DELETE_CARD_EXCEPTION",UI_ACTN_GET_PASSWORD_PROTECTION_EXCEPTION:"UI_ACTN_GET_PASSWORD_PROTECTION_EXCEPTION",UI_ACTN_SET_PASSWORD_PROTECTION_EXCEPTION:"UI_ACTN_SET_PASSWORD_PROTECTION_EXCEPTION",UI_ACTN_DECLINE_TRANSFER_EXCEPTION:"UI_ACTN_DECLINE_TRANSFER_EXCEPTION",UI_ACTN_CANCEL_TRANSFER_EXCEPTION:"UI_ACTN_CANCEL_TRANSFER_EXCEPTION",UI_ACTN_VERIFY_CARD_EXCEPTION:"UI_ACTN_VERIFY_CARD_EXCEPTION",UI_ACTN_VALIDATE_BIN_EXCEPTION:"UI_ACTN_VALIDATE_BIN_EXCEPTION",UI_ACTN_GET_ELIGIBILITY_EXCEPTION:"UI_ACTN_GET_ELIGIBILITY_EXCEPTION",UI_ACTN_GET_FRIEND_LIST_EXCEPTION:"UI_ACTN_GET_FRIEND_LIST_EXCEPTION",UI_ACTN_GET_BANNER_STATES_EXCEPTION:"UI_ACTN_GET_BANNER_STATES_EXCEPTION",UI_ACTN_INCREMENT_BANNER_VIEW_EXCEPTION:"UI_ACTN_INCREMENT_BANNER_VIEW_EXCEPTION",UI_ACTN_INCREMENT_BANNER_DISMISSAL_EXCEPTION:"UI_ACTN_INCREMENT_BANNER_DISMISSAL_EXCEPTION",UI_ACTN_CREATE_M_TRANSFER_EXCEPTION:"UI_ACTN_CREATE_M_TRANSFER_EXCEPTION",UI_ACTN_CREATE_FI_TRANSER_EXCEPTION:"UI_ACTN_CREATE_FI_TRANSER_EXCEPTION",UI_ACTN_GET_PLATFORM_CONTEXT_EXCEPTION:"UI_ACTN_GET_PLATFORM_CONTEXT_EXCEPTION",UI_ACTN_DISMISS_PLATFORM_CONTEXT_EXCEPTION:"UI_ACTN_DISMISS_PLATFORM_CONTEXT_EXCEPTION",UI_ACTN_MARK_SOLD_CONTEXT_EXCEPTION:"UI_ACTN_MARK_SOLD_CONTEXT_EXCEPTION",UI_ACTN_GET_ADDRESSES_EXCEPTION:"UI_ACTN_GET_ADDRESSES_EXCEPTION",UI_ACTN_ADD_ADDRESS_EXCEPTION:"UI_ACTN_ADD_ADDRESS_EXCEPTION",UI_ACTN_CREATE_CART_EXCEPTION:"UI_ACTN_CREATE_CART_EXCEPTION",UI_ACTN_SET_CART_ADDRESS_EXCEPTION:"UI_ACTN_SET_CART_ADDRESS_EXCEPTION",UI_ACTN_GET_PROFILE_EXCEPTION:"UI_ACTN_GET_PROFILE_EXCEPTION",UI_ACTN_CREATE_REQUEST_EXCEPTION:"UI_ACTN_CREATE_REQUEST_EXCEPTION",UI_ACTN_DECLINE_REQUEST_EXCEPTION:"UI_ACTN_DECLINE_REQUEST_EXCEPTION",UI_ACTN_CANCEL_REQUEST_EXCEPTION:"UI_ACTN_CANCEL_REQUEST_EXCEPTION",UI_ACTN_GET_PENDING_REQUESTS_EXCEPTION:"UI_ACTN_GET_PENDING_REQUESTS_EXCEPTION",UI_ACTN_GROUP_SELL_INTEREST_QP_DIALOG_SHOWN:"UI_ACTN_GROUP_SELL_INTEREST_QP_DIALOG_SHOWN",UI_ACTN_GROUP_SELL_INTEREST_QP_DIALOG_NEXT_CLICK:"UI_ACTN_GROUP_SELL_INTEREST_QP_DIALOG_NEXT_CLICK"};},null);
__d("StickerAssetType",[],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={IMAGE:"BestEffortImage",SPRITE:"SpriteImage",PADDED_SPRITE:"PaddedSpriteImage"};},null);
__d('AjaxRequest',['ErrorUtils','Keys','PHPQuerySerializer','TimeSlice','URI','UserAgent_DEPRECATED','getSameOriginTransport','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();function p(t,u,v){this.xhr=n();if(!(u instanceof l))u=new l(u);if(v&&t=='GET'){u.setQueryData(v);}else this._params=v;this.method=t;this.uri=u;this.xhr.open(t,u);}var q=window.XMLHttpRequest&&'withCredentials' in new XMLHttpRequest();p.supportsCORS=function(){return q;};p.ERROR='ar:error';p.TIMEOUT='ar:timeout';p.PROXY_ERROR='ar:proxy error';p.TRANSPORT_ERROR='ar:transport error';p.SERVER_ERROR='ar:http error';p.PARSE_ERROR='ar:parse error';p.SERVICE_UNAVAILABLE='ar:noservice';p._inflight=[];function r(){var t=p._inflight;p._inflight=[];t.forEach(function(u){u.abort();});}function s(t){t.onJSON=t.onError=t.onSuccess=null;clearTimeout(t._timer);if(t.xhr&&t.xhr.readyState<4){t.xhr.abort();t.xhr=null;}p._inflight=p._inflight.filter(function(u){return u&&u!=t&&u.xhr&&u.xhr.readyState<4;});}Object.assign(p.prototype,{timeout:60000,streamMode:true,prelude:/^for \(;;\);/,status:null,_eol:-1,_call:function(t){if(this[t])this[t](this);},_parseStatus:function(){var t;try{this.status=this.xhr.status;t=this.xhr.statusText;}catch(u){if(this.xhr.readyState>=4){this.errorType=p.TRANSPORT_ERROR;this.errorText=u.message;}return;}if(this.status===0&&!/^(file|ftp)/.test(this.uri)){this.errorType=p.TRANSPORT_ERROR;}else if(this.status>=100&&this.status<200){this.errorType=p.PROXY_ERROR;}else if(this.status>=200&&this.status<300){return;}else if(this.status>=300&&this.status<400){this.errorType=p.PROXY_ERROR;}else if(this.status>=400&&this.status<500){this.errorType=p.SERVER_ERROR;}else if(this.status===503){this.errorType=p.SERVICE_UNAVAILABLE;}else if(this.status>500&&this.status<600){this.errorType=p.PROXY_ERROR;}else if(this.status==1223){return;}else if(this.status>=12001&&this.status<=12156){this.errorType=p.TRANSPORT_ERROR;}else{t='unrecognized status code: '+this.status;this.errorType=p.ERROR;}if(!this.errorText)this.errorText=t;},_parseResponse:function(){var t,u=this.xhr.readyState;try{t=this.xhr.responseText||'';}catch(v){if(u>=4){this.errorType=p.ERROR;this.errorText='responseText not available - '+v.message;}return;}while(this.xhr){var w=this._eol+1,x=this.streamMode?t.indexOf('\n',w):t.length;if(x<0&&u==4)x=t.length;if(x<=this._eol)break;var y=t;if(this.streamMode)y=t.substr(w,x-w).replace(/^\s*|\s*$/g,'');if(w===0&&this.prelude)if(this.prelude.test(y))y=y.replace(this.prelude,'');this._eol=x;if(y){try{this.json=JSON.parse(y);}catch(v){var z=/(<body[\S\s]+?<\/body>)/i.test(t)&&RegExp.$1,aa={message:v.message,'char':w,excerpt:(w===0&&z||y).substr(512)};this.errorType=p.PARSE_ERROR;this.errorText='parse error - '+JSON.stringify(aa);return;}h.applyWithGuard(this._call,this,['onJSON']);}}},_onReadyState:function(){var t=this.xhr&&this.xhr.readyState||0;if(this.status==null&&t>=2)this._parseStatus();if(!this.errorType&&this.status!=null)if(t==3&&this.streamMode||t==4)this._parseResponse();if(this.errorType||t==4){this._time=Date.now()-this._sentAt;this._call(!this.errorType?'onSuccess':'onError');s(this);}},send:function(t){this.xhr.onreadystatechange=k.guard(this._onReadyState.bind(this),'AjaxRequest xhr.onreadystatechange');var u=this.timeout;if(u)this._timer=o((function(){this.errorType=p.TIMEOUT;this.errorText='timeout';this._time=Date.now()-this._sentAt;this._call('onError');s(this);}).bind(this),u);p._inflight.push(this);if(this.method=='POST')this.xhr.setRequestHeader('Content-Type','application/x-www-form-urlencoded');this._sentAt=Date.now();this.xhr.send(t?j.serialize(t):'');},abort:function(){s(this);},toString:function(){var t='[AjaxRequest readyState='+this.xhr.readyState;if(this.errorType)t+=' errorType='+this.errorType+' ('+this.errorText+')';return t+']';},toJSON:function(){var t={json:this.json,status:this.status,errorType:this.errorType,errorText:this.errorText,time:this._time};if(this.errorType)t.uri=this.uri;for(var u in t)if(t[u]==null)delete t[u];return t;}});if(window.addEventListener&&m.firefox())window.addEventListener('keydown',function(event){if(event.keyCode===i.ESC)event.prevent();},false);if(window.attachEvent)window.attachEvent('onunload',r);f.exports=p;},null);
__d('ChannelSubdomain',['Event','JSLogger','Run','setTimeoutAcrossTransitions','LogHistory','WebStorage'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=c('LogHistory').getInstance('channel'),m=c('WebStorage').getLocalStorage(),n=i.create('channel'),o='channel_sub:',p=7,q=100*1000,r=null,s;function t(){if(s){clearTimeout(s);s=null;}if(m&&r!=null)m.removeItem(o+r);r=null;}function u(v,w,x){var y=(v-1)*p;if(x){if(s)clearTimeout(s);r=s=null;}if(w==null)w=Math.floor(Math.random()*y);if(r==null)if(m){var z=[];for(var aa=0;aa<m.length;aa++){var ba=m.key(aa);if(ba.indexOf(o)===0){var ca=parseInt(ba.substr(o.length),10);z[ca]=parseInt(m.getItem(ba),10);}}var da=Date.now()-q;for(aa=0;aa<y;aa++){var ea=(aa+w)%y;if(!z[ea]||z[ea]<da){r=ea;break;}}if(r!=null){var fa=function(){try{m.setItem(o+r,Date.now());}catch(ga){l.warn('subdomain set failed',ga.message);}s=k(fa,q/2);};fa();}else{l.warn('no channel subdomain',z);n.error('subdomain_overflow');}if(typeof window.onpageshow!='undefined'){h.listen(window,'pagehide',t);}else j.onUnload(t);}else r=w;return r==null?null:r%p;}f.exports={allocate:u,clear:t};},null);
__d('DocRPC',['ErrorUtils'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i={_apis:{},_dispatch:function(j){var k;try{j=JSON.parse(j);}catch(l){throw new Error('DocRPC unparsable dispatch: "'+j+'"');}if(i._apis.hasOwnProperty(j.api)){var m=i._apis[j.api];if(m[j.method])k=h.applyWithGuard(m[j.method],m,j.args);}if(k===undefined)k=null;return JSON.stringify(k);},publish:function(j,k){i._apis[k]=j;},proxy:function(j,k,l){var m={};l.forEach(function(n){m[n]=function(){var o={api:k,method:n,args:Array.prototype.slice.call(arguments)},p;try{if(j.closed)throw new Error('DocRPC window closed');p=j.DocRPC._dispatch(JSON.stringify(o));}catch(q){h.reportError(q);return;}if(typeof p=='string')try{p=JSON.parse(p);}catch(q){throw new Error('DocRPC '+k+'.'+n+' unparsable return: "'+p+'"');}return p;};});return m;}};f.exports=b.DocRPC=i;},null);
__d('ChannelTransport',['AjaxRequest','ChannelConstants','DocRPC','LogHistory','TimeSlice','URI','bind','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=k.getInstance('channel');function q(){return (1048576*Math.random()|0).toString(36);}function r(ba,ca){var da=ba.subdomain;da=da===null?'':da+'-';var ea=ba.host;ea=ea===null||ea===undefined?'edge-chat':ba.host;var fa=new m(ca).setDomain(da+ea+'.'+ba.domain).setPort(ba.port).setSecure(new m(window.location.href).isSecure());return fa;}function s(ba){var ca={partition:ba.partition,cb:q(),failure:ba.pingFailuresOnSubdomain};if(ba.sticky_token)ca.sticky_token=ba.sticky_token;if(ba.sticky_pool)ca.sticky_pool=ba.sticky_pool;var da=r(ba,'/p').setQueryData(ca);p.log('start_p',{uri:da.toString()});var ea=new h('GET',da);if(h.supportsCORS())ea.xhr.withCredentials=true;var fa=function(ga){p.log('finish_p',{xhr:ga.toJSON?ga.toJSON():ga,subdomain:ba.subdomain,fullHost:ba.fullHost});};ea.onError=function(ga){fa(ga);if(ba.subdomain===null)return;ba.pingFailuresOnSubdomain++;ba.subdomain++;if(ba.subdomain>6)ba.subdomain=0;};ea.timeout=ba.P_TIMEOUT;ea.onSuccess=fa;ea.send();}function t(ba,ca,da){var ea=new Image(),fa=0,ga=function(ja){ea.abort();return ja?ca():da();};ea.onload=l.guard(function(){p.log('ping_ok',{duration:Date.now()-fa});ga(true);},'ChannelTransport image.onload');ea.onerror=l.guard(function(){s(ba);ga(false);},'ChannelTransport image.onerror');var ha=o(ea.onerror,10000);ea.abort=function(){if(ha){clearTimeout(ha);ha=null;}ea.onload=ea.onerror=null;};var ia={partition:ba.partition,cb:q()};if(ba.sticky_token)ia.sticky_token=ba.sticky_token;if(ba.sticky_pool)ia.sticky_pool=ba.sticky_pool;if(ba.lastRequestErrorReason){ia.reason=ba.lastRequestErrorReason;ba.lastRequestErrorReason=null;}if(ba.uid&&ba.viewerUid){ia.uid=ba.uid;ia.viewer_uid=ba.viewerUid;}if(ba.watchdog&&ba.watchdog.enabled)ia.wtc=ba.watchdog.doSerialize();fa=Date.now();ea.src=r(ba,'/ping').setQueryData(ia);return ea;}function u(ba,ca){var da={channel:ba.user_channel,partition:ba.partition,clientid:ba.sessionID,cb:q(),cap:0,uid:ba.uid,viewer_uid:ba.viewerUid};if(ba.sticky_token)da.sticky_token=ba.sticky_token;if(ba.sticky_pool)da.sticky_pool=ba.sticky_pool;if(ba.profile)da.profile=ba.profile;if(ba.capabilities)da.cap=ba.capabilities;da.id=ca;var ea=r(ba,'/add_bud').setQueryData(da),fa=new h('GET',ea);if(h.supportsCORS())fa.xhr.withCredentials=true;fa.onError=function(ga){p.warn('add_buddy_error');};fa.onSuccess=function(ga){p.log('add_buddy_ok');};fa.timeout=ba.P_TIMEOUT;fa.send();}function v(ba){var ca={channel:ba.user_channel,partition:ba.partition,clientid:ba.sessionID,cb:q(),cap:0,uid:ba.uid,viewer_uid:ba.viewerUid};if(ba.sticky_token)ca.sticky_token=ba.sticky_token;if(ba.sticky_pool)ca.sticky_pool=ba.sticky_pool;if(ba.is_offline||ba.shouldSuppressPresence){ca.state='offline';}else ca.state='active';if(ca.state===ba.lastPresenceState)return;ba.lastPresenceState=ca.state;if(ba.profile)ca.profile=ba.profile;if(ba.capabilities)ca.cap=ba.capabilities;var da=r(ba,'/active_ping').setQueryData(ca),ea=new h('GET',da);if(h.supportsCORS())ea.xhr.withCredentials=true;ea.onError=function(fa){p.warn('active_ping_error');};ea.onSuccess=function(fa){p.log('active_ping_ok');};ea.timeout=ba.P_TIMEOUT;ea.send();}function w(ba,ca,da,ea){var fa=new Date(),ga=-1;if(ba.userActive>0){ga=(fa-ba.userActive)/1000|0;if(ga<0)p.warn('idle_regression',{idleTime:ga,now:fa.getTime(),userActive:ba.userActive});}var ha={channel:ba.user_channel,seq:ba.seq,partition:ba.partition,clientid:ba.sessionID,cb:q(),idle:ga,qp:'y',cap:0};if(!!ba.watchdog&&ba.watchdog.enabled)ha.wtc=ba.watchdog.doSerialize();if(ba.ready)if(ba.seqTurSentAt==-1||ba.seqTurSentAt==ba.seq){ha.tur=ba.timeUntilReady;ha.qpmade=ba.queueMade;ba.seqTurSentAt=ba.seq;}if(ba.sequenceId>0)ha.isq=ba.sequenceId;ha.msgs_recv=ba.estimatedReceived;if(ba.uid&&ba.viewerUid){ha.uid=ba.uid;ha.viewer_uid=ba.viewerUid;}if(ba.sticky_token){ha.sticky_token=ba.sticky_token;}else{if(ba.requestBatchedPull)ha.request_batch=1;if(ba.msgr_region)ha.msgr_region=ba.msgr_region;}if(ba.sticky_pool)ha.sticky_pool=ba.sticky_pool;if('trace_id' in ba)ha.traceid=ba.trace_id;if(ba.is_offline||ba.shouldSuppressPresence){ha.state='offline';}else if(ba.userActive>0&&ga<60)ha.state='active';ba.lastPresenceState=ha.state;if(ba.streamingCapable){ha.mode='stream';ha.format='json';}if(ba.profile)ha.profile=ba.profile;if(ba.capabilities)ha.cap=ba.capabilities;var ia=r(ba,'/pull').setQueryData(ha),ja='GET',ka=new h(ja,ia);if(h.supportsCORS())ka.xhr.withCredentials=true;ka.timeout=ba.streamingCapable?ba.STREAMING_TIMEOUT:ba.LONGPOLL_TIMEOUT;ka.onJSON=ca;ka.onSuccess=da;ka.onError=function(){var la=this.status==12002&&this._time>=ba.MIN_12002_TIMEOUT||this.status==504&&this._time>=ba.MIN_504_TIMEOUT,ma=la?da:ea;return ma&&ma.apply(this,arguments);};ka.send();ba.inStreaming=ba.streamingCapable;return ka;}function x(ba){this.manager=ba;this.init&&this.init();}function y(ba){x.apply(this,arguments);}Object.assign(y.prototype,{logName:'CORS',enterState:function(ba,ca){if(this._request){this._request.abort();this._request=null;}if(ba=='init')o(n(this.manager,'exitState',{status:i.OK,stateId:ca.stateId}),0);if(!/pull|ping/.test(ba))return;var da=this.manager;if(ba=='ping'){this._request=t(ca,n(da,'exitState',{status:i.OK,stateId:ca.stateId}),n(da,'exitState',{status:i.ERROR,stateId:ca.stateId}));}else if(ba=='pull')this._request=w(ca,n(da,'_processTransportData',ca.stateId),n(da,'exitState',{status:i.OK,stateId:ca.stateId}),n(da,'exitState',{status:i.ERROR,stateId:ca.stateId}));}});function z(ba){p.log('iframe_init_constructor');x.apply(this,arguments);this._iframe=document.createElement('iframe');this._iframe.style.display='none';document.body.appendChild(this._iframe);j.publish(this,'outerTransport');}Object.assign(z.prototype,{logName:'iframe',_initIframe:function(ba){p.log('iframe_init_start');window.onchanneliframeready=function(){p.log('iframe_resources');return ba.resources;};window.onchanneliframeloaded=function(){p.log('iframe_loaded');};if(ba){this._iframeURI=r(ba,ba.path);if(ba.resources){var ca=this._iframeURI.getDomain();ba.resources=ba.resources.map(function(fa){var ga=new m(fa);if(ga.getPath().startsWith('/intern/rsrc.php')&&ga.getQueryData().origin!==undefined)return ga.addQueryData('origin',ca).toString();return fa;});}if(ba.bustIframe){var da={partition:ba.partition,cb:q()};this._iframeURI.setQueryData(da);}}else this._iframeURI='about:blank';this._iframeProxy=null;try{this._iframe.contentWindow.location.replace(this._iframeURI);p.log('iframe_uri_set');}catch(ea){p.error('iframe_uri_set_error',ea);this.exitState({status:i.ERROR,stateId:ba.stateId},ea+'');}},enterState:function(ba,ca){if(ba=='init'){this._initIframe(ca);}else if(/idle|ping|pull/.test(ba)){if(this._iframeProxy){this._iframeProxy.enterState.apply(this._iframeProxy,arguments);}else if(ba!='idle')this.exitState({status:i.ERROR,stateId:ca.stateId},'iframe not yet loaded');}else if(ba=='shutdown')this._initIframe();},_processTransportData:function(){this.manager._processTransportData.apply(this.manager,arguments);},exitState:function(ba){if(this.manager.state=='init'&&ba.status==i.OK)this._iframeProxy=j.proxy(this._iframe.contentWindow,'innerTransport',['enterState'],(this._iframeURI+'').replace(/iframe.*/,''));if(/ping|pull/.test(this.manager.state)&&!this._iframeProxy)return;this.manager.exitState.apply(this.manager,arguments);}});function aa(){this.init=this.init.bind(this);x.apply(this,arguments);}Object.assign(aa.prototype,{logName:'iframe(inner)',init:function(){j.publish(this,'innerTransport');try{var ca=j.proxy(window.parent,'outerTransport',['_processTransportData','exitState'],top.DocRPC.origin);Object.assign(this,ca);this.exitState({status:i.OK,stateId:1e+06});}catch(ba){p.error('iframe_inner_init_error',ba);}},enterState:function(ba,ca){if(this._request){this._request.abort();this._request=null;}if(ba=='ping'){this._request=t(ca,n(this,'exitState',{status:i.OK,stateId:ca.stateId}),n(this,'exitState',{status:i.ERROR,stateId:ca.stateId}));}else if(ba=='pull')this._request=w(ca,n(this,'_processTransportData',ca.stateId),n(this,'exitState',{status:i.OK,stateId:ca.stateId}),n(this,'exitState',{status:i.ERROR,stateId:ca.stateId}));}});f.exports={getURI:r,Transport:x,CORSTransport:y,IframeTransport:z,IframeInnerTransport:aa,sendActivePing:v,sendAdditionalBuddyRequest:u};},null);
__d('FBAjaxRequest',['AjaxRequest','getAsyncParams'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k,l,m){m=babelHelpers._extends({},i(k),m);var n=new h(k,l,m);n.streamMode=false;var o=n._call;n._call=function(p){if(p=='onJSON'&&this.json){if(this.json.error){this.errorType=h.SERVER_ERROR;this.errorText='AsyncResponse error: '+this.json.error;}this.json=this.json.payload;}o.apply(this,arguments);};n.ajaxReqSend=n.send;n.send=function(p){this.ajaxReqSend(babelHelpers._extends({},p,m));};return n;}f.exports=j;},null);
__d('FantailLogger',['Bootloader','FantailConfig'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={debug:function(k,l){for(var m=arguments.length,n=Array(m>2?m-2:0),o=2;o<m;o++)n[o-2]=arguments[o];if(i.enabled)h.loadModules(["FantailLogQueue"],function(p){var q;(q=p.get(k)).debug.apply(q,[l].concat(n));});},info:function(k,l){for(var m=arguments.length,n=Array(m>2?m-2:0),o=2;o<m;o++)n[o-2]=arguments[o];if(i.enabled)h.loadModules(["FantailLogQueue"],function(p){var q;(q=p.get(k)).info.apply(q,[l].concat(n));});},warn:function(k,l){for(var m=arguments.length,n=Array(m>2?m-2:0),o=2;o<m;o++)n[o-2]=arguments[o];if(i.enabled)h.loadModules(["FantailLogQueue"],function(p){var q;(q=p.get(k)).warn.apply(q,[l].concat(n));});},error:function(k,l){for(var m=arguments.length,n=Array(m>2?m-2:0),o=2;o<m;o++)n[o-2]=arguments[o];if(i.enabled)h.loadModules(["FantailLogQueue"],function(p){var q;(q=p.get(k)).error.apply(q,[l].concat(n));});}};f.exports=j;},null);
__d("MovingStat",[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){i=i||60000;var j={t:new Date(),count:0,v:0},k=j,l=0,m=0;function n(){var o=new Date()-i;while(k&&k.next&&k.t<o){l-=k.v;m-=k.count;k=k.next;}}this.add=function(o){l+=o;m++;var p=new Date();if(p-j.t<1000){j.v+=o;j.count++;}else{j.next={t:p,v:o,count:1};j=j.next;n();}};this.tally=function(o){o=o||1000;n();return {sum:l,count:m,timeAverage:l*o/i};};}f.exports=h;},null);
__d('RTISession',['URI','AjaxRequest','invariant','ErrorUtils'],function a(b,c,d,e,f,g,h,i,j,k){'use strict';if(c.__markCompiled)c.__markCompiled();var l='.facebook.com';function m(n,o,p,q,r,s,t,u,v){!n?j(0):undefined;!q?j(0):undefined;!r?j(0):undefined;this.domain=n;this.port=o;this.edgePoolName=p;this.stickyToken=q;this.loggedInId=r;this.accountId=s;this.clientProfile=t||'desktop';this.clientId=u;this.capabilities=v;}m.prototype.issueRequest=function(n,o,p,q,r){!n?j(0):undefined;!o?j(0):undefined;!q?j(0):undefined;var s=this.domain.length-l.length,t=s>0&&this.domain.indexOf(l,s)!==-1,u=t?this.domain:this.domain+l,v=(1048576*Math.random()|0).toString(36),w={cb:v,sticky_token:this.stickyToken,uid:this.loggedInId,viewer_uid:this.accountId,sticky_pool:this.edgePoolName,profile:this.clientProfile,clientid:this.clientId,cap:this.capabilities};for(var x in w)!!o[x]?j(0):undefined;Object.assign(w,o);var y=new h(n).setDomain(u).setPort(this.port).setSecure(new h(window.location.href).isSecure()).setQueryData(w),z=p?'POST':'GET',aa=new i(z,y);aa.timeout=r?r*1000:30000;if(aa.xhr)aa.xhr.withCredentials=true;var ba={};aa.onSuccess=function(){};aa.onJSON=(function(){ba.data=aa.json;ba.error=null;k.applyWithGuard(q,this,[ba]);}).bind(this);aa.onError=(function(){ba.data=null;ba.error=aa.errorType||'error';k.applyWithGuard(q,this,[ba]);}).bind(this);aa.send(JSON.stringify(p));};f.exports=m;},null);
__d('ChannelManager',['AjaxRequest','Arbiter','AsyncRequest','ChannelClientID','ChannelConstants','ChannelInitialData','ChannelSubdomain','ChannelTransport','ChatConfig','ChatVisibility','DTSG','Env','FantailLogger','FBAjaxRequest','FBRTCSupport','ISB','JSLogger','LogHistory','MessagingRealtimeConstants','MovingStat','PresenceCookieManager','PresenceState','PresenceUtil','RTISession','Run','SystemEvents','URI','UserActivity','errorCode','requestAnimationFrameAcrossTransitions','setIntervalAcrossTransitions','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma){if(c.__markCompiled)c.__markCompiled();var na,oa=x.create('channel'),pa=y.getInstance('channel_manager'),qa=null;function ra(fb){qa=fb;}var sa={idle:{ok:'init!'},init:{ok:'pull!',error:'reconnect',sys_online:'init',sys_timetravel:'init'},pull:{ok:'pull!',error:'ping',error_missing:'pull',error_msg_type:'pull',refresh_0:'reconnect',refresh_110:'reconnect',refresh_111:'reconnect',refresh_112:'pull',refresh_113:'pull',refresh_117:'reconnect'},ping:{ok:'pull!',error:'ping',error_stale:'reconnect!'},reconnect:{ok:'init!',error:'reconnect',sys_online:'reconnect',sys_timetravel:'reconnect'},shutdown:{},_all:{error_max:'shutdown!',error_shutdown:'shutdown!',sys_owner:'reconnect',sys_nonowner:'idle!',sys_online:'ping',sys_offline:'idle!',sys_timetravel:'ping'}},ta={reconnectOverrideTimeMillis:Date.now(),userActive:Date.now(),created:Date.now(),ready:false,seqTurSentAt:-1,queueMade:'',sequenceId:0,lastPresenceState:null,lastRequestErrorReason:null,seq:0,pingFailuresOnSubdomain:0,estimatedReceived:0,sessionID:k.getID(),capabilities:v.getCapabilities(),streamingCapable:false,inStreaming:false,shouldSuppressPresence:ca.shouldSuppress(),LONGPOLL_TIMEOUT:60000,STREAMING_TIMEOUT:60000,P_TIMEOUT:30000,IFRAME_LOAD_TIMEOUT:30000,MIN_RETRY_INTERVAL:5000,MAX_RETRY_INTERVAL:320000,MIN_12002_TIMEOUT:9000,MIN_504_TIMEOUT:20000,STALL_THRESHOLD:180000,JUMPSTART_THRESHOLD:90000,MIN_INIT_PROBE_DELAY:3000,INIT_PROBE_DELAY_RANDOMIZE_RANGE:12000,CHANNEL_PROXY_REPORTING_MIN_INTERVAL:10000,PROBE_DELAY:60000,PROBE_HEARTBEATS_INTERVAL_LOW:1000,PROBE_HEARTBEATS_INTERVAL_HIGH:5000,STREAMING_EXIT_STATE_ON_CONTINUE:false},ua={MAX_CONTINUOUS_PULL_FAILS:3,enabled:false,uptimeMillis:Date.now(),timeInGoodStatesStartMillis:Date.now(),timeInGoodStatesMillis:0,initialized:false,firstPullSentTimeMillis:Date.now(),accumulatedPullTimeMillis:0,pullStartTimeMillis:0,pingCount:0,pullCount:0,continuousPullFails:0,getTimeSinceFirstPullSentSeconds:function(){return (Date.now()-this.firstPullSentTimeMillis)/1000;},getUptimeSeconds:function(){return (Date.now()-this.uptimeMillis)/1000;},getAccumulatedPullTimeSeconds:function(){var fb=this.accumulatedPullTimeMillis,gb=Date.now();if(this.pullStartTimeMillis>0&&gb-this.pullStartTimeMillis<=ta.LONGPOLL_TIMEOUT)fb+=gb-this.pullStartTimeMillis;var hb=fb/1000;if(hb>=this.getTimeSinceFirstPullSentSeconds())this.initialize();return hb;},getPingToPullRatio:function(){return this.pullCount===0?0:this.pingCount/this.pullCount;},reportPullSent:function(){if(!this.enabled)return;if(!this.initialized)this.initialize();this.pullStartTimeMillis=Date.now();},initialize:function(){this.initialized=true;this.firstPullSentTimeMillis=Date.now();this.pullStartTimeMillis=0;this.accumulatedPullTimeMillis=0;this.pingCount=0;this.pullCount=0;this.timeInGoodStatesStartMillis=Date.now();this.timeInGoodStatesMillis=0;this.uptimeMillis=Date.now();},reportPullReturned:function(fb,gb){if(!this.enabled)return;if(this.pullStartTimeMillis>0){this.accumulatedPullTimeMillis+=Date.now()-this.pullStartTimeMillis;if(fb){this.pullCount++;this.continuousPullFails=0;}else this.continuousPullFails++;}this.pullStartTimeMillis=0;},reportPingSent:function(){if(!this.enabled)return;this.pingCount++;},isGoodState:function(fb){return fb.indexOf('pull')===0||fb.indexOf('init')===0||fb.indexOf('idle')===0;},getTotalTimeInGoodStatesSeconds:function(){var fb=this.timeInGoodStatesMillis;if(this.timeInGoodStatesStartMillis>0)fb+=Date.now()-this.timeInGoodStatesStartMillis;return fb/1000;},clientEnteredState:function(fb){if(!this.enabled)return;var gb=this.isGoodState(fb);if(gb&&this.timeInGoodStatesStartMillis===0){this.timeInGoodStatesStartMillis=Date.now();}else if(!gb&&this.timeInGoodStatesStartMillis>0){this.timeInGoodStatesMillis=Date.now()-this.timeInGoodStatesStartMillis;this.timeInGoodStatesStartMillis=0;}},transportEnteredState:function(fb){if(!this.enabled)return;if(fb.indexOf('pull')===0){this.reportPullSent();}else if(fb.indexOf('ping')===0&&ta.lastRequestErrorReason!==l.SYS_TIMETRAVEL&&ta.lastRequestErrorReason!==l.SYS_ONLINE&&ta.lastRequestErrorReason!==l.SYS_OWNER&&ta.lastRequestErrorReason!==l.SYS_NONOWNER)this.reportPingSent();},doSerialize:function(){if(!this.enabled)return '';return this.getTimeSinceFirstPullSentSeconds().toFixed(0)+','+this.getAccumulatedPullTimeSeconds().toFixed(0)+','+this.getPingToPullRatio().toFixed(3)+','+this.getUptimeSeconds().toFixed(0)+','+this.getTotalTimeInGoodStatesSeconds().toFixed(0);}},va=1,wa={},xa=0;function ya(){return j.lastSuccessTime?Math.round((Date.now()-j.lastSuccessTime)/1000):-1;}function za(){var fb={};if(na.getConfig('host'))fb[na.getConfig('user_channel')]=na.getConfig('seq',0);return fb;}function ab(){var fb=Date.now(),gb=Date.now(),hb={total:0},ib='idle',jb=false;ga.subscribe([ga.USER,ga.ONLINE,ga.TIME_TRAVEL],function(mb,nb){cb(true);gb=null;na.lastPullTime=Date.now();var ob;switch(mb){case ga.USER:ob=ga.isPageOwner()?l.SYS_OWNER:l.SYS_NONOWNER;break;case ga.ONLINE:ob=nb?l.SYS_ONLINE:l.SYS_OFFLINE;break;case ga.TIME_TRAVEL:ob=l.SYS_TIMETRAVEL;break;}na.exitState({status:ob,stateId:va});});var kb=function(mb,nb){var ob=Date.now(),pb=null;if(nb){fb=ob;pb=nb.nextState||nb.state;}else pb=ib;ga.checkTimeTravel();if(gb){var qb=Math.round((ob-gb)/1000);if(qb>0){hb[ib]=(hb[ib]||0)+qb;hb.total+=qb;}}ib=pb;gb=ob;if(!mb){hb.lastSuccessTime=ya();hb.online=ga.isOnline();pa.log('rollup',hb);}};i.subscribe(l.ON_ENTER_STATE,kb);la(kb,60000);i.subscribe(x.DUMP_EVENT,function(mb,nb){nb.channelRollup=hb;});var lb=function(){if(na.isShutdown()||na.shouldIdle())return;ga.checkTimeTravel();var mb=Date.now()-(na.lastPullTime||s.start);if(!jb&&mb>ta.STALL_THRESHOLD){var nb=ya();pa.error('stall',{lastSuccessTime:nb,rollupState:ib});jb=true;}var ob=Date.now()-fb;if(na.state=='pull'&&ob>ta.JUMPSTART_THRESHOLD){fb=null;pa.warn('jumpstart',{state:na.state,dormant:ob});na.enterState('init');}};la(lb,10000);}function bb(){var fb=Date.now(),gb=1;function hb(){ma(hb,gb*1000);var mb=na.state;if(mb=='idle'&&na.shouldIdle())return;oa.bump('conn_t',gb);if(mb=='pull')oa.bump('conn_t_pull',gb);}hb();var ib=[15,30,60,120,240],jb=false,kb=false;function lb(mb){ma(function(){oa.rate('pullenter_'+mb,jb);oa.rate('pullexit_'+mb,kb);},mb*1000);}while(ib.length)lb(ib.shift());i.subscribe(l.ON_ENTER_STATE,function(mb,nb){if(nb.state=='pull')jb=true;fb=Date.now();});i.subscribe(l.ON_EXIT_STATE,function(mb,nb){if(nb.state!='pull'||!fb)return;var ob='other';if(nb.status==l.OK){kb=true;ob='ok';}else if(nb.xhr&&nb.xhr.errorType){ob=/ar:(\w+)/.test(nb.xhr.errorType)&&RegExp.$1;}else if(/^sys_/.test(nb.status))return;var pb=(Date.now()-fb)/1000;if(pb<0){return;}else if(pb>3600)pb=3600;oa.bump('conn_num');oa.bump('conn_exit',pb);oa.bump('conn_num_'+ob);oa.bump('conn_exit_'+ob,pb);});}function cb(fb){if(fb){xa=0;wa={};}else xa++;}function db(){var fb=!h.supportsCORS()||ta.forceIframe;if(ta.subdomain===null||fb){ta.fullHost=ta.host;}else ta.fullHost=ta.subdomain+'-'+ta.host;}na={state:'idle',nextState:null,proxyDown:false,lastPullTime:Date.now(),lastReportOnMisguidedMsgTime:Date.now(),heartbeats:[],setTestCallback:ra,backoff:false,sessionRegistered:false,init:function(fb,gb){this.init=function(){};i.subscribe(l.GET_RTI_SESSION_REQUEST,(function(event,kb){this.informCurrentSession();}).bind(this));ka(function(){t.info(l.FANTAIL_SERVICE,'client initialized');t.info(l.FANTAIL_SERVICE,'using session id: %s at seq: %d with sticky: %s/%s',ta.sessionID,ta.sequenceId,ta.sticky_token,ta.sticky_pool);ua.enabled=!!ta.watchdog_enabled;ta.watchdog=ua;ia.subscribe(function(){ta.userActive=Date.now();o.sendActivePing(ta);});});ba.register('ch',za);var hb=this.getConfig('max_conn',2);ta.subdomain=n.allocate(hb);this._transportRate=new aa(30000);var ib=h.supportsCORS()&&!ta.forceIframe?'CORSTransport':'IframeTransport';this.transport=new o[ib](this);if(fb)this.enterState(fb,gb);ka((function(){i.subscribe(x.DUMP_EVENT,(function(event,kb){kb.transportRate=this._transportRate.tally();kb.transportType=ib;kb.transportVersion=2;}).bind(this));ab();bb();}).bind(this));if(na.getConfig('tryStreaming')&&na.getConfig('host')&&h.supportsCORS()&&!ta.forceIframe){var jb=ta.MIN_INIT_PROBE_DELAY+Math.random()*ta.INIT_PROBE_DELAY_RANDOMIZE_RANGE;ma(this._probeTest,jb);}},configure:function(){for(var fb=arguments.length,gb=Array(fb),hb=0;hb<fb;hb++)gb[hb]=arguments[hb];pa.log('configure',gb);gb.forEach(function(ib){return Object.assign(ta,ib);});db();i.inform(l.ON_CONFIG,this);},getConfig:function(fb,gb){return fb in ta?ta[fb]:gb;},getCompleteConfig:function(){return ta;},informCurrentSession:function(){var fb=null;if(this.sessionRegistered&&ta&&ta.fullHost&&ta.sticky_token&&ta.uid)fb=new ea(ta.fullHost,ta.port,ta.sticky_pool,ta.sticky_token,ta.uid,ta.viewerUid,ta.profile,ta.sessionID,ta.capabilities);i.inform(l.RTI_SESSION,fb);},getWatchdog:function(){return ua;},isShutdown:function(){return this.state=='shutdown';},shouldIdle:function(){return !(ga.isPageOwner()&&ga.isOnline());},_sendIframeError:function(fb){var gb=new j().setURI('/ajax/presence/reconnect.php').setData({reason:fb,fb_dtsg:r.getToken()}).setOption('suppressErrorHandlerWarning',true).setOption('retries',1).setMethod('GET').setReadOnly(true).setAllowCrossPageTransition(true);gb.specifiesWriteRequiredParams()&&gb.send();},_getDelay:function(){var fb=Math.min(ta.MIN_RETRY_INTERVAL*Math.pow(2,Math.max(0,xa-1)),ta.MAX_RETRY_INTERVAL);if(this.proxyDown&&'proxy_down_delay_millis' in ta)fb=ta.proxy_down_delay_millis;this.proxyDown=false;return Math.floor(fb*(1+Math.random()*.5));},enterState:function(){if(this._inEnterState)pa.warn('enterstate_recursion');this._inEnterState=true;try{this._enterState.apply(this,arguments);this._inEnterState=false;}catch(fb){this._inEnterState=false;throw fb;}},_enterState:function(fb){if((fb.indexOf('pull')===0||fb.indexOf('ping')===0||fb.indexOf('shutdown')===0)&&!!ta.active_config_refresh){var gb=Date.now(),hb=(gb-ta.reconnectOverrideTimeMillis)/1000;if('config_refresh_seconds' in ta&&ta.config_refresh_seconds>0&&hb>ta.config_refresh_seconds){fb='reconnect';t.debug(l.FANTAIL_SERVICE,'forcing reconnect to refresh config - this is normal behavior');}}if(fb.indexOf('reconnect')===0)ta.reconnectOverrideTimeMillis=Date.now();var ib=this.backoff?this._getDelay():0;this.backoff=false;if(this.isShutdown()){t.warn(l.FANTAIL_SERVICE,'not executing state due to shutdown mode: %s',fb);return;}if(fb!='idle!'&&this.shouldIdle()){t.warn(l.FANTAIL_SERVICE,'forced idleness');return;}va++;ta.stateId=va;clearTimeout(this._deferredTransition);this._deferredTransition=null;this.transport.enterState('idle');this.state='idle';this.nextState=null;if(/!$/.test(fb)){var jb=this._transportRate.tally().timeAverage,kb=na.getConfig('MAX_CHANNEL_STATES_PER_SEC',1);if(jb>=kb){if(!this._throttled){this._throttled=true;pa.warn('throttled');}oa.bump('throttle');ib=1000/kb;}}else if(!(/#$/.test(fb)))ib=this._getDelay();fb=fb.replace(/\W*$/,'');if(!sa[fb]){t.error(l.FANTAIL_SERVICE,'invalid state: %s',fb);throw new Error('invalid state:'+fb);}var lb=Array.from(arguments),mb;if(ib<=0){mb={state:fb};this._transportRate.add(1);this.state=fb;var nb=this['_enter_'+this.state];if(nb){lb.shift();nb.apply(this,lb);}if(/init|idle|pull|ping/.test(this.state)){if(ta.streamingCapable&&/pull/.test(this.state))this.heartbeats=[];ua.transportEnteredState(fb);ua.clientEnteredState(fb);ta.is_offline=!q.isOnline();ta.capabilities=v.getCapabilities();t.info(l.FANTAIL_SERVICE,'entering transport state: %s',this.state);this.transport.enterState(this.state,ta);if(this.state=='ping'){mb.url=o.getURI(ta).toString();mb.port=ta.port||'undefined';}}}else{this.state='idle';this.nextState=fb;mb={state:this.state,delay:ib,nextState:fb};lb[0]=fb+'#';this._deferredTransition=ma((function(){this._deferredTransition=null;this.enterState.apply(this,lb);}).bind(this),ib);}if(/pull/.test(fb)){mb.client_id=ta.sessionID;mb.streaming=ta.inStreaming;}i.inform(l.ON_ENTER_STATE,mb);},exitState:function(fb,gb){var hb=fb.stateId,ib=fb.status;if((ib==l.SYS_TIMETRAVEL||ib==l.SYS_ONLINE||ib==l.SYS_NONOWNER||ib==l.SYS_OWNER)&&ua)ua.initialize();if(this.isShutdown()||hb<va)return;var jb=this.state,kb=Array.from(arguments);kb[0]=fb.status;var lb={state:jb,status:ib};if(/pull/.test(jb)){lb.client_id=ta.sessionID;lb.streaming=ta.inStreaming;}if(/ping/.test(jb)&&ib!=l.OK)lb.url=o.getURI(ta).toString();if(this.nextState)lb.nextState=this.nextState;if(gb&&gb.errorType){ta.lastRequestErrorReason=gb.errorType;lb.xhr=gb.toJSON?gb.toJSON():gb;if(gb.errorType==h.SERVICE_UNAVAILABLE){t.error(l.FANTAIL_SERVICE,'got 5xx http status code, setting long delay');this.proxyDown=true;}delete lb.xhr.json;}else if(ib!=l.OK)ta.lastRequestErrorReason=ib;if(gb&&gb.json){if(gb.json.t)lb.t=gb.json.t;if(gb.json.reason)lb.reason=gb.json.reason;if(gb.json.seq)lb.seq=gb.json.seq;}i.inform(l.ON_EXIT_STATE,lb);var mb=this['_exit_'+jb];if(mb)ib=mb.apply(this,kb)||ib;if(ib!=l.OK){cb();wa[jb]=(wa[jb]||0)+1;}var nb=sa[this.nextState||jb][ib]||sa._all[ib],ob=nb&&nb.replace(/!*$/,'');if(!ob){pa.error('terminal_transition',lb);this._shutdownHint=l.HINT_INVALID_STATE;nb='shutdown!';t.error(l.FANTAIL_SERVICE,'entering shutdown state');}this._lastState=jb;this._lastStatus=ib;this.enterState(nb);},_processTransportData:function(fb,gb){this._processTransportData0(fb,gb,gb.json);},_processTransportData0:function(fb,gb,hb){var ib=hb.t;if('s' in hb){hb.seq=hb.s;delete hb.s;}if(hb.u&&ta.user&&hb.u!=ta.user){pa.warn('misguided_msg',{user:ta.user,target:hb.u});this._reportProxyMisguidedMsg(hb.u,ta.user);return;}var jb=ta.seq;if('seq' in hb){ta.seq=hb.seq;ca.doSync();}switch(ib){case 'continue':if(ta.inStreaming&&this.heartbeats.length<1){ta.streamingCapable=false;pa.log('switch_to_longpoll');ma(this._probeTest,ta.PROBE_DELAY);}cb(true);if(!ta.inStreaming||ta.STREAMING_EXIT_STATE_ON_CONTINUE)this.exitState({status:l.OK,stateId:fb});break;case 'refresh':case 'refreshDelay':t.info(l.FANTAIL_SERVICE,'got refresh with reason: %s',hb.reason);this.exitState({status:'refresh_'+(hb.reason||0),stateId:fb},gb);break;case 'backoff':t.warn(l.FANTAIL_SERVICE,'server told client to back off');cb();this.backoff=true;break;case 'lb':var kb=hb.lb_info;if(kb){ta.sticky_token=kb.sticky;if('pool' in kb)ta.sticky_pool=kb.pool;if('vip' in kb)ta.host=kb.vip;db();}else pa.error('missing_lb_info');break;case 'test_streaming':ma(this._probeTest,500);break;case 'fullReload':ba.clear();pa.log('full_reload');this.sessionRegistered=true;this.informCurrentSession();i.inform(l.ON_INVALID_HISTORY);cb(true);t.info(l.FANTAIL_SERVICE,'full reload incurred');var lb=l.OK;this.exitState({status:lb,stateId:fb},gb);if('ms' in hb)this._processMessages(hb,jb);break;case 'msg':cb(true);this._processMessages(hb,jb);break;case 'heartbeat':if(ta.inStreaming){var mb=Date.now();if(this.heartbeats.length>0)var nb=mb-this.heartbeats[this.heartbeats.length-1];pa.log('heartbeat_interval',{client_id:ta.sessionID,interval:nb});this.heartbeats.push(mb);}break;case 'batched':var ob=hb.batches,pb;for(pb=0;pb<ob.length;pb++)this._processTransportData0(fb,gb,ob[pb]);break;default:t.error(l.FANTAIL_SERVICE,'got an unknown protocol message: %s',ib);pa.error('unknown_msg_type',{type:ib});break;}},_processMessages:function(fb,gb){var hb,ib,jb,kb;if('tr' in fb)ta.trace_id=fb.tr;ib=fb.ms;jb=ta.seq-ib.length;for(hb=0;hb<ib.length;hb++,jb++){ta.estimatedReceived++;if(jb>=gb){kb=ib[hb];if(kb.type){var lb=l.getArbiterType(kb.type);if(kb.type==='messaging'){var mb={type:'messaging',event:kb.event};if(kb.message){mb.inbox_unread=kb.unread_counts&&kb.unread_counts.inbox;mb.tid=kb.message.tid;mb.mid=kb.message.mid;t.info(l.FANTAIL_SERVICE,'got message with id: %s',kb.message.mid);}}else if(kb.type==='pages_messaging'){if(kb.unread_counts&&kb.unread_counts.inbox)i.inform(l.getArbiterType('pages_inbox_count_update'),{page_id:kb[z.VIEWER_FBID],inbox_unread:kb.unread_counts.inbox});}else if(kb.type==='skywalker'){lb=l.SKYWALKER;}else if(kb.type==='qprimer'){kb.first=!ta.ready;if(kb.first){ta.ready=true;ta.timeUntilReady=Date.now()-ta.created;ta.queueMade=kb.made;}lb=l.CHANNEL_ESTABLISHED;}else if(kb.type==='delta')ta.sequenceId=kb.iseq;i.inform(lb,{obj:kb});}}else pa.warn('seq_regression',{seq:jb,last_seq:gb,messages:ib.length});}},_enter_init:function(){if(wa.init>=na.getConfig('MAX_INIT_FAILS',2))return setTimeout(this.exitState.bind(this,{status:l.ERROR_MAX,stateId:va}),0);this._initTimer=ma(this.exitState.bind(this,{status:l.ERROR,stateId:va},'timeout'),ta.IFRAME_LOAD_TIMEOUT);},_enter_reconnect:function(fb){pa.warn('enter_reconnect',fb);t.info(l.FANTAIL_SERVICE,'entered reconnect with reason: %s',fb);var gb=va;if(!da.hasUserCookie()){t.warn(l.FANTAIL_SERVICE,'user has no cookie???');pa.warn('no_user_cookie');setTimeout(function(){na._shutdownHint=l.HINT_AUTH;na.exitState({status:l.ERROR_SHUTDOWN,stateId:gb});},0);return;}var hb={reason:fb,fb_dtsg:r.getToken()};if(w.token)hb.fb_isb=w.token;if(qa)qa(hb);var ib=new u('GET','/ajax/presence/reconnect.php',hb);ib.onSuccess=(function(){na.configure(ib.json);ba.store();this.exitState({status:l.OK,stateId:gb});}).bind(this);ib.onError=(function(){var jb=ib.json&&ib.json.error;t.error(l.FANTAIL_SERVICE,'reconnect error: %s',ib.errorType);if(ib.errorType==h.TRANSPORT_ERROR||ib.errorType==h.PROXY_ERROR||ib.errorType==h.SERVICE_UNAVAILABLE)this._shutdownHint=l.HINT_CONN;if(jb&&jb==1356007){this._shutdownHint=l.HINT_MAINT;}else if(jb==1357001||jb==1357004||jb==1348009){this._shutdownHint=l.HINT_AUTH;}else this._shutdownHint=null;this.exitState({status:this._shutdownHint?l.ERROR_SHUTDOWN:l.ERROR,stateId:gb},ib);}).bind(this);ib.send();},_enter_shutdown:function(){i.inform(l.ON_SHUTDOWN,{reason:this._shutdownHint});if(!!ta.shutdown_recovery_enabled&&'shutdown_recovery_interval_seconds' in ta&&ta.shutdown_recovery_interval_seconds>0){var fb=ta.shutdown_recovery_interval_seconds*1000;ma((function(){i.inform(l.ATTEMPT_RECONNECT);this.state='reconnect!';this.enterState('reconnect!');}).bind(this),fb);}},_exit_init:function(fb){if(this._initTimer)this._initTimer=clearTimeout(this._initTimer);if(fb==l.ERROR_MAX)this._sendIframeError(l.reason_IFrameLoadGiveUp);},_exit_pull:function(fb,gb){var hb=fb==l.OK;ua.reportPullReturned(hb,this);if(hb){this.lastPullTime=Date.now();}else{var ib='exit status: '+fb;if(gb&&gb.errorType)ib+=' ajax request error: '+gb.errorType;t.error(l.FANTAIL_SERVICE,'pull failed with status: %s',ib);}},_exit_ping:function(fb){if(fb==l.OK){var gb=Date.now()-(this.lastPullTime||s.start);if(gb>ta.STALL_THRESHOLD){t.error(l.FANTAIL_SERVICE,'didnt complete a successful pull for too long');return l.ERROR_STALE;}}else t.error(l.FANTAIL_SERVICE,'ping failed with status: %s',fb);},_reportProxyMisguidedMsg:function(fb,gb){t.error(l.FANTAIL_SERVICE,'misguided message to %d meant for %d',gb,fb);var hb=Date.now();if(hb-this.lastReportOnMisguidedMsgTime<=ta.CHANNEL_PROXY_REPORTING_MIN_INTERVAL)return;this.lastReportOnMisguidedMsgTime=hb;var ib={received_uid:fb,expected_uid:gb};if(ta.sticky_token)ib.sticky_token=ta.sticky_token;var jb=new ha('/err_misguided_msg').setDomain(ta.host+'.'+ta.domain).setPort(ta.port).setSecure(new ha(window.location.href).isSecure()).setQueryData(ib),kb=new h('GET',jb);if(h.supportsCORS())kb.xhr.withCredentials=true;kb.onSuccess=function(lb){};kb.onError=function(lb){};kb.onJSON=function(lb,mb){};kb.send();},_probeTest:function(){ta.streamingCapable=false;var fb=[],gb={mode:'stream',format:'json'};if(ta.sticky_token)gb.sticky_token=ta.sticky_token;var hb=new ha('/probe').setDomain(ta.host+'.'+ta.domain).setPort(ta.port).setSecure(new ha(window.location.href).isSecure()).setQueryData(gb),ib=new h('GET',hb);ib.onJSON=function(jb,kb){if(jb&&jb.json&&jb.json.t==='heartbeat'){fb.push(Date.now());if(fb.length>=2){var lb=fb[1]-fb[0];if(lb>=ta.PROBE_HEARTBEATS_INTERVAL_LOW&&lb<=ta.PROBE_HEARTBEATS_INTERVAL_HIGH){ta.streamingCapable=true;pa.log('switch_to_streaming');}}}};ib.onSuccess=function(jb){if(fb.length!=2){ta.streamingCapable=false;pa.error('probe_error',{error:'beats.length = '+fb.length});}pa.log('probe_success');};ib.onError=function(jb){ta.streamingCapable=false;pa.error('probe_error',jb);};ib.send();}};f.exports=na;function eb(){if(m.channelConfig){na.configure(m.channelConfig);if(/shutdown/.test(m.state))na._shutdownHint=l[m.reason];na.init(m.state,m.reason);}}if(p.get('early_channel',false)){eb();}else fa.onAfterLoad(eb);},6);
__d('ChannelConnection',['Arbiter','Run','SystemEvents','ChannelConstants','ChannelManager','JSLogger','setTimeoutAcrossTransitions'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o=m.create('channel_connection'),p=null,q=null,r=null,s=null,t=0,u=Object.assign(new h(),{CONNECTED:'chat-connection/connected',RECONNECTING:'chat-connection/reconnecting',SHUTDOWN:'chat-connection/shutdown',MUTE_WARNING:'chat-connection/mute',UNMUTE_WARNING:'chat-connection/unmute'});i.onBeforeUnload(function(){});function v(){if(q){clearTimeout(q);q=null;}}function w(){v();o.log('unmute_warning');u.inform(u.UNMUTE_WARNING);}function x(ca){v();q=n(w,ca);o.log('mute_warning',{time:ca});u.inform(u.MUTE_WARNING);}function y(){if(r){clearTimeout(r);r=null;}}function z(ca,da){y();if(ca===k.ON_ENTER_STATE&&(da.nextState||da.state)==='pull'){if(s!==u.CONNECTED){o.log('connected');var ea=!s;s=u.CONNECTED;t=0;u.inform(u.CONNECTED,{init:ea});}}else if(ca===k.ON_ENTER_STATE&&((da.nextState||da.state)==='ping'||!da.nextState&&da.state==='idle')){r=n(function(){var fa=null;if(!(da.state==='idle'&&!da.nextState))fa=da.delay||0;o.log('reconnecting',{delay:fa});if(u.disconnected())o.log('reconnecting_ui',{delay:fa});s=u.RECONNECTING;da.state==='idle'&&t++;if(t>1){u.inform(u.RECONNECTING,fa);}else if(!da.nextState&&da.state==='idle')z(ca,da);},500);}else if(ca===k.ON_SHUTDOWN){o.log('shutdown',{reason:da.reason});s=u.SHUTDOWN;t=0;u.inform(u.SHUTDOWN,da.reason);}}function aa(){if(l.isShutdown()){z(k.ON_SHUTDOWN,l._shutdownHint);}else z(k.ON_ENTER_STATE,{state:l.state,nextState:l.nextState,delay:0});}i.onAfterLoad(aa);Object.assign(u,{disconnected:function(){return s===u.SHUTDOWN||s===u.RECONNECTING&&!q&&t>1;},isShutdown:function(){return s===u.SHUTDOWN;},reconnect:function(ca){if(l.state==='ping'||l.isShutdown())return;o.log('reconnect',{now:ca});u.inform(u.RECONNECTING,0);if(!!ca){if(p!==null){clearTimeout(p);p=null;}l.enterState('ping!');}else if(!p)p=n(function(){l.enterState('ping!');p=null;},k.CHANNEL_MANUAL_RECONNECT_DEFER_MSEC);},unmuteWarning:w});function ba(){h.subscribe([k.ON_ENTER_STATE,k.ON_SHUTDOWN],z);h.subscribe(k.ATTEMPT_RECONNECT,function(){if(u.disconnected())u.reconnect();});j.subscribe(j.TIME_TRAVEL,function(){u.reconnect();x(k.MUTE_WARNING_TIME_MSEC);});i.onBeforeUnload(y,false);}i.onAfterLoad(ba);u.mockAfterLoad=function(){aa();ba();};f.exports=u;},null);
__d('TypingDetector',['ArbiterMixin','Event','Input','Run','SubscriptionsHandler','TypingStates','createObjectFrom','emptyFunction'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();function p(q,r){this._input=q;this._ignoreKeys={};this._getValueFn=r;}Object.assign(p.prototype,h,{_timeout:7000,_currentState:m.INACTIVE,init:function(){this.init=o;this.reset();this._subscriptions=new l();this._subscriptions.addSubscriptions(i.listen(this._input,'keyup',this._update.bind(this)),k.onUnload(this._onunload.bind(this)));},reset:function(){clearTimeout(this._checkTimer);this._checkTimer=null;this._lastKeystrokeAt=null;this._currentState=m.INACTIVE;},setIgnoreKeys:function(q){this._ignoreKeys=n(q);},destroy:function(){this._subscriptions.release();},_onunload:function(){if(this._currentState==m.TYPING)this._transition(m.QUITTING);},_update:function(event){var q=i.getKeyCode(event),r=this._currentState;if(!this._ignoreKeys[q]){var s=this._getValueFn?this._getValueFn():j.getValue(this._input);if(s.trim().length===0){if(r==m.TYPING)this._transition(m.INACTIVE);}else if(r==m.TYPING){this._recordKeystroke();}else if(r==m.INACTIVE){this._transition(m.TYPING);this._recordKeystroke();}}},_transition:function(q){this.reset();this._currentState=q;this.inform('change',q);},_recordKeystroke:function(){this._lastKeystrokeTime=Date.now();if(!this._checkTimer)this._checkTimer=setTimeout(this._checkTyping.bind(this),this._timeout);},_checkTyping:function(){var q=this._lastKeystrokeTime+this._timeout,r=Date.now();if(r>q){this._transition(m.INACTIVE);}else{clearTimeout(this._checkTimer);this._checkTimer=setTimeout(this._checkTyping.bind(this),q-r+10);}}});f.exports=p;},null);
__d('TypingDetectorController',['AsyncRequest','AvailableList','AvailableListConstants','ChannelConnection','ChatVisibility','Keys','MercuryServerRequestsConfig','TypingDetector','TypingStates','emptyFunction','setTimeoutAcrossTransitions','shield'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s){if(c.__markCompiled)c.__markCompiled();function t(u,v,w,x,y,z){'use strict';this.userID=u;this.input=v;this.source=w;this.threadID=y;this.remoteState=p.INACTIVE;this.notifyTimer=null;x=x||{};this.notifyDelay=x.notifyDelay||this.notifyDelay;this._typingDetector=new o(v,z);this._typingDetector.init(x);this._typingDetector.subscribe('change',this._stateChange.bind(this));}t.prototype.setUserAndThread=function(u,v){'use strict';if(this.userID!==u||this.threadID!==v){this.resetState();this.userID=u;this.threadID=v;}};t.prototype.setIgnoreEnter=function(u){'use strict';var v=u?[m.RETURN]:[];this._typingDetector.setIgnoreKeys(v);};t.prototype.resetState=function(){'use strict';this._notifyState(p.INACTIVE);this.remoteState=p.INACTIVE;this._typingDetector.reset();clearTimeout(this.notifyTimer);this.notifyTimer=null;};t.prototype.destroy=function(){'use strict';this.resetState();this._typingDetector.destroy();};t.prototype._stateChange=function(u,v){'use strict';if(v!=p.QUITTING){clearTimeout(this.notifyTimer);this.notifyTimer=r(s(this._notifyState,this,v),this.notifyDelay);}else this._notifyState(v,true);};t.prototype._notifyState=function(u,v){'use strict';if(!this.userID&&!this.threadID||!l.isOnline()||u===this.remoteState||k.disconnected())return;this._sendRequest(u,this.userID,v);};t.prototype._sendRequest=function(u,v,w){'use strict';this.remoteState=u;var x={typ:u,to:v,source:this.source,thread:this.threadID},y=new h().setHandler(this._onTypResponse.bind(this,v)).setErrorHandler(q).setData(x).setURI('/ajax/messaging/typ.php').setAllowCrossPageTransition(true).setOption('asynchronous_DEPRECATED',!w);if(n.msgrRegion)y.setRequestHeader('X-MSGR-Region',n.msgrRegion);y.send();};t.prototype._onTypResponse=function(u,v){'use strict';var w=v.getPayload()||{};if(w.offline)i.set(u,j.OFFLINE,'typing_response');};Object.assign(t.prototype,{notifyDelay:1000});f.exports=t;},null);
__d('SplitImage.react',['React','Image.react','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k){if(c.__markCompiled)c.__markCompiled();var l=h.createClass({displayName:'SplitImage',render:function(){var m=this.props.size;return (h.createElement('div',babelHelpers._extends({},this.props,{className:k(this.props.className,"_55lt"),style:babelHelpers._extends({},this.props.style||{},{width:m,height:m})}),this.renderImages()));},renderImages:function(){if(!this.props.srcs)return null;var m=this.props.srcs,n=Array.isArray(m);if(n){m=m.filter(function(o){return o!==null;});if(!m.length)return null;}if(!n||m.length==1)return this.renderOne(n?m[0]:m);return m.length==2?this.renderTwo(m):this.renderThree(m);},renderOne:function(m){return (h.createElement(i,{src:m,width:this.props.size,height:this.props.size,alt:''}));},renderTwo:function(m){var n=this.props.size,o=Math.floor(n/2),p=-Math.floor(o/2),q="_55lu"+(this.props.border?' '+"_57xo":'');return (h.createElement('div',null,h.createElement('div',{className:"_55lu",style:{width:o}},h.createElement(i,{src:m[0],width:n,height:n,style:{marginLeft:p},alt:''})),h.createElement('div',{className:q,style:{width:o}},h.createElement(i,{src:m[1],width:n,height:n,style:{marginLeft:p},alt:''}))));},renderThree:function(m){var n=this.props.size,o=Math.floor(n/3*2),p=-Math.floor((n-o)/2),q=Math.floor(n/2),r=n-o,s=-Math.floor((q-r)/2),t="_55lu"+(this.props.border?' '+"_57pl":''),u="_55lu"+(this.props.border?' '+"_57pm":'');return (h.createElement('div',null,h.createElement('div',{className:t,style:{width:o}},h.createElement(i,{src:m[0],width:n,height:n,style:{marginLeft:p},alt:''})),h.createElement('div',{className:u,style:{width:r,height:q}},h.createElement(i,{src:m[1],width:q,height:q,style:{marginLeft:s},alt:''})),h.createElement('div',{className:"_55lu",style:{width:r,height:q}},h.createElement(i,{src:m[2],width:q,height:q,style:{marginLeft:s},alt:''}))));}});f.exports=l;},null);
__d('MercuryMessageDeliveryState',[],function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={SENDING:1,SENT:2,DELIVERED:3,ERROR:0,UNKNOWN:-1};f.exports=h;},null);
__d('MercuryMessageInfo',['MercuryActionStatus','MercuryMessageDeliveryState','MercuryViewer'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k={isOutbound:function(l){return l.author===j.getID();},isInbound:function(l){return !k.isOutbound(l);},isSending:function(l){return (l.status===h.UNSENT||l.status===h.UNCONFIRMED||l.status===h.UNABLE_TO_CONFIRM||l.status===h.RESENDING);},isSent:function(l){return (l.status===undefined||l.status===h.SUCCESS);},hasError:function(l){return (l.status===h.FAILED_UNKNOWN_REASON||l.status===h.UNABLE_TO_CONFIRM||l.status===h.ERROR);},getDeliveryState:function(l,m){if(this.hasError(l))return i.ERROR;if(this.isSending(l))return i.SENDING;if(this.isSent(l)){if(l.timestamp<=m)return i.DELIVERED;return i.SENT;}return i.UNKNOWN;}};f.exports=k;},null);
__d('MercuryErrorInfo',['MercuryErrorType','MercuryMessageInfo','fbt'],function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k={getMessage:function(l){var m='';if(k.isConnectionError(l)){m=j._("This message didn't send.");if(k.isTransient(l))m=j._("{message} Check your internet connection and click to try again.",[j.param('message',m)]);}else{if(l&&l.description){m=l.description;}else m=j._("This message failed to send.");if(k.isTransient(l))m=j._("{message} Click to send again.",[j.param('message',m)]);}return m;},isConnectionError:function(l){if(l&&l.type==h.TRANSPORT)return l.code===1001||l.code===1004||l.code===1006;return false;},isTransient:function(l){return l&&l.is_transient;},isPermanent:function(l){return l?!this.isTransient(l):false;},hasErrorStatus:function(l){return i.hasError(l);}};f.exports=k;},null);
__d('MercuryMessageError.react',['CurrentUser','ImmutableObject','MercuryErrorInfo','MercuryMessageActions','React','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){'use strict';if(c.__markCompiled)c.__markCompiled();var o=l.PropTypes,p=l.createClass({displayName:'MercuryMessageError',propTypes:{authorFBID:o.string,message:o.instanceOf(i).isRequired},getDefaultProps:function(){return {authorFBID:h.getID()};},render:function(){var q=this.props.message,r=q.error_data;return (l.createElement('div',babelHelpers._extends({},this.props,{className:n(this.props.className,this._getClassNameFromStatus(q)),tabIndex:j.isTransient(r)?0:null,onClick:j.isTransient(r)?this.messageResend:null}),l.createElement('div',{className:"_2fs1"}),l.createElement('span',{dangerouslySetInnerHTML:{__html:this._getTextFromStatus(q)}})));},messageResend:function(){k.getForFBID(this.props.authorFBID).resend(this.props.message);},_getClassNameFromStatus:function(q){if(j.hasErrorStatus(q)){return "_2fs2"+(' '+"_2fs3")+(j.isTransient(q.error_data)?' '+"_2fs4":'')+(j.isPermanent(q.error_data)?' '+"_2fs5":'');}else return "_2fs6 _2fs2";},_getTextFromStatus:function(q){var r='',s=q.error_data;if(j.hasErrorStatus(q))r=j.getMessage(s);if(typeof r==='object'&&r.__html)r=r.__html;return r;}});f.exports=p;},null);
__d('PhotoStoreCore',[],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={actions:{UPDATE:'update'},_photoCache:{},_postCreateCallbacks:{},getPhotoCache:function(i){if(!this._photoCache[i])throw new Error('Photo cache requested for unknown set ID');return this._photoCache[i];},hasBeenCreated:function(i){return !!this._photoCache[i];},clearSetCache:function(i){delete this._photoCache[i];delete this._postCreateCallbacks[i];},getByIndex:function(i,j,k){this.getPhotoCache(i).getItemAtIndex(j,k);},getByIndexImmediate:function(i,j){if(this._photoCache[i])return this._photoCache[i].getItemAtIndexImmediate(j);return undefined;},getItemsInAvailableRange:function(i){var j=this.getAvailableRange(i),k=[];for(var l=j.offset;l<j.length;l++)k.push(this.getByIndexImmediate(i,l));return k;},getItemsAfterIndex:function(i,j,k,l){var m=this.getCursorByIndexImmediate(i,j);this.fetchForward(i,m,k,l);},getAllByIDImmediate:function(i){var j=Object.keys(this._photoCache);return j.map((function(k){return this.getByIndexImmediate(k,this.getIndexForID(k,i));}).bind(this)).filter(function(k){return !!k;});},getIndexForID:function(i,j){if(this._photoCache[i])return this._photoCache[i].getIndexForID(j);return undefined;},getEndIndex:function(i){var j=this.getAvailableRange(i);return j.offset+j.length-1;},getCursorByIndexImmediate:function(i,j){var k=this.getByIndexImmediate(i,j);if(k)return this._photoCache[i].getCursorForID(k.id);return undefined;},hasNextPage:function(i){var j=this.getCursorByIndexImmediate(i,this.getEndIndex(i));return this.getPhotoCache(i).hasNextPage(j);},getAvailableRange:function(i){return this.getPhotoCache(i).getAvailableRange();},hasLooped:function(i){return this.getPhotoCache(i).hasLooped();},fetchForward:function(i,j,k,l){this.getPhotoCache(i).getItemsAfterCursor(j,k,l);},fetchBackward:function(i,j,k,l){this.getPhotoCache(i).getItemsBeforeCursor(j,k,l);},executePostCreate:function(i,j){if(this._photoCache[i]){j&&j();}else this._postCreateCallbacks[i]=j;},runPostCreateCallback:function(i){var j=this._postCreateCallbacks[i];if(j){j();delete this._postCreateCallbacks[i];}},setPreFetchCallback:function(i,j){this.getPhotoCache(i).setPreFetchCallback(j);},updateData:function(i){var j=i.set_id;if(!this._photoCache[j]){this._photoCache[j]=new i.cache_class(i);this.runPostCreateCallback(j);}else if(i.query_metadata.action==h.actions.UPDATE){this._photoCache[j].updateData(i);}else this._photoCache[j].addData(i);},updateFeedbackData:function(i){var j=Object.keys(i);j.forEach(function(k){return h.getAllByIDImmediate(k).forEach(function(l){l.feedback=i[k].feedback;});});},reset:function(){Object.keys(this._photoCache).forEach((function(i){return this.clearSetCache(i);}).bind(this));}};f.exports=h;},null);
__d('MessengerHotLikePreviewEvents',['mixInEventEmitter'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i={START:'start',STOP:'stop',POP:'pop',REMOVE:'remove',FINISH_ANIMATION:'finish_animation'};h(i,{start:true,stop:true,pop:true,remove:'remove',finish_animation:'finish_animation'});f.exports=i;},null);
__d("XStickerAssetController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/asset\/",{sticker_id:{type:"Int",required:true},image_type:{type:"Enum",defaultValue:"BestEffortImage",enumType:1}});},null);
__d('MessengerHotLikeUtils',['EmojiLikeConstants','StickerAssetType','StickerConstants','XStickerAssetController'],function a(b,c,d,e,f,g,h,i,j,k){'use strict';if(c.__markCompiled)c.__markCompiled();var l={SizeTimes:{small:1000,medium:2000,large:3000},getStickerIDForTime:function(m){var n=null;switch(true){case m<this.SizeTimes.small:n=j.HOT_LIKE_SMALL_STICKER_ID;break;case m<this.SizeTimes.medium:n=j.HOT_LIKE_MEDIUM_STICKER_ID;break;case m<this.SizeTimes.large:n=j.HOT_LIKE_LARGE_STICKER_ID;break;}return n;},getEmojiSizeForTime:function(m){var n=null;if(m<this.SizeTimes.small){n=h.size.SMALL;}else if(m<this.SizeTimes.medium){n=h.size.MEDIUM;}else if(m<this.SizeTimes.large)n=h.size.LARGE;return n;},getGrowCoefficientForSince:function(m){return Math.min(1,(Date.now()-m)/this.SizeTimes.large);},getMetadataForHotLike:function(m){var n;switch(m){case j.HOT_LIKE_LARGE_STICKER_ID:n=120;break;case j.HOT_LIKE_MEDIUM_STICKER_ID:n=84;break;case j.HOT_LIKE_SMALL_STICKER_ID:n=35;break;case h.size.LARGE:n=64;break;case h.size.MEDIUM:n=64;break;case h.size.SMALL:n=32;break;}return n?{height:n,width:n}:undefined;},getPreviewURI:function(){return k.getURIBuilder().setInt('sticker_id',j.HOT_LIKE_LARGE_STICKER_ID).setEnum('image_type',i.IMAGE).getURI().toString();},getURIWithID:function(m){return k.getURIBuilder().setInt('sticker_id',m).setEnum('image_type',i.IMAGE).getURI().toString();}};f.exports=l;},null);
__d('MessengerContextBannerBootloader',['BootloadedComponent.react','CurrentUser','DOM','JSResource','React','ReactDOM'],function a(b,c,d,e,f,g,h,i,j,k,l,m){'use strict';if(c.__markCompiled)c.__markCompiled();function n(q,r,s,t,u){var v=j.create('div');o(q,r,function(w){m.render(w,v,s(v));},t,u);}function o(q,r,s,t,u,v){v=babelHelpers._extends({left:0,position:'absolute',right:0,top:0},v);p({otherUserFBIDs:t&&[t],threadID:q,style:v},r,s,u);}function p(q,r,s,t){s(l.createElement(h,babelHelpers._extends({bootloadPlaceholder:l.createElement('div',{style:{height:80}}),bootloadLoader:k('MessengerContextBannerContainer.react'),location:r,onResize:t,viewer:i.getID()},q)));}f.exports={bootload:n,getBootloadedComponent:o};},null);
__d('MessengerHotLikeSVG.react',['React','cssVar','cx','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k){'use strict';if(c.__markCompiled)c.__markCompiled();var l=h.PropTypes,m='transparent',n=h.createClass({displayName:'MessengerHotLikeSVG',propTypes:{color:l.string,strokeOnly:l.bool},getDefaultProps:function(){return {strokeOnly:false};},render:function(){var o=this.props,p=o.color,q=o.strokeOnly;p=p||"#0084ff";var r=q?m:p,s=q?p:m;return (h.createElement('div',{className:k(this.props.className,"_1i1j")},h.createElement('svg',{height:'100%',version:'1.1',viewBox:'0 0 381 400',width:'100%',x:'0px',y:'0px'},h.createElement('g',null,h.createElement('g',null,h.createElement('path',{d:'M0,399.8h86.4V160.8H0V399.8z M381,220.7c0-13.6-7.4-25.5-18.5-31.8c8.8-6.6,14.5-17.4,14.5-29.3 c0-20.1-16.4-36.8-36.5-36.8H217c20.4-106.5-31.3-128.2-51.7-123c-12.3,3.1-13.6-0.3-11.4,24.2l3.4,42.7c0.3,3.5,0,7.2-0.8,10.8 c-0.8,3.6-2.7,6.9-4.6,10L106.8,160v208.7h195.3v-1.2c19.2-1.1,34.5-17.4,34.5-36.9c0-6.1-1.5-12-4.1-17 c17.3-2.8,30.4-18,30.4-36.1c0-8.2-2.7-15.9-7.4-22C370.1,250.8,381,237,381,220.7z',fill:r,stroke:s,strokeLinecap:'round',strokeWidth:'5%'}))))));}});f.exports=n;},null);
__d('FBRTCExperiment',['FBRTCExperimentsConfig','QE'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();j.gen=function(k){var l={params:{},in_experiment:false,auto_exposure:false},m=h[k]||l,n=new j(k,m.params,m.in_experiment);if(m.auto_exposure)n.logExposure(k);return n;};function j(k,l,m){this.$FBRTCExperiment1=k;this.$FBRTCExperiment2=l;this.$FBRTCExperiment3=m;}j.prototype.logExposure=function(){if(this.$FBRTCExperiment3)i.logExposure(this.$FBRTCExperiment1);};j.prototype.getParam=function(k,l){if(this.$FBRTCExperiment2[k])return this.$FBRTCExperiment2[k].toString();return l;};j.prototype.getInt=function(k,l){if(this.$FBRTCExperiment2[k])return parseInt(this.$FBRTCExperiment2[k],10);return l;};j.prototype.getBool=function(k,l){var m=this.$FBRTCExperiment2;if(m[k])return m[k]==='1'||m[k]===1||m[k]==='true';return l;};f.exports=j;},null);
__d('EmojiLikeUtils',['EmoticonsList','EmojiLikeConstants','MercuryConfig','MercuryTagHelper','SupportedEmoji','Utf16'],function a(b,c,d,e,f,g,h,i,j,k,l,m){'use strict';if(c.__markCompiled)c.__markCompiled();var n,o,p=i.size,q='/images/emoji/unicode/emoji_',r='/images/emoticons/',s=(n={},n[p.SMALL]='_16-2x',n[p.MEDIUM]='_64',n[p.LARGE]='_64',n),t=(o={},o[p.MEDIUM]='-2x',o),u='.png',v='emoji',w='emoticon',x=new RegExp('([\u203C\u2049\u2100-\u21FF\u2300-\u27FF'+'\u2900-\u29FF\u2B00-\u2BFF\u3000-\u30FF\u3200-\u32FF]|'+'\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDEFF])([\uFE00-\uFE0F])?'),y=function(da){if(!j.BubblelessEmojiRenderingGK)return false;var ea=da||'',fa=[],ga=null;while(ea.length>0){ea=ea.trim();if(h.noncapturingRegexp.test(ea)){ga=h.noncapturingRegexp.exec(ea);fa.push({type:w,title:ga[1],id:h.emotes[ga[1]]});ea=ea.replace(h.noncapturingRegexp,'');}else if(x.test(ea)){var ha=x.exec(ea);if(!ha||!ha.length)return false;ga=ha[1];var ia=m.decode(ga),ja=l.emoji[ia];if(!ja)return false;fa.push({type:v,id:ia.toString(16)});ea=ea.replace(x,'');}else return false;}return fa;};function z(da){return i.TAG_PREFIX+':'+da;}function aa(da){return !!(da&&k.get(da,i.TAG_PREFIX));}function ba(da,ea){return (q+m.decode(da).toString(16)+s[ea]+u);}function ca(da){var ea=p.LARGE,fa=p.MEDIUM,ga=[];if(da)da.forEach(function(ha){if(ha.type===v){ga.push({type:ha.type,title:undefined,url:q+ha.id+s[ea]+u});}else ga.push({type:ha.type,title:ha.title,url:r+ha.id+t[fa]+u});});return ga;}f.exports={getTag:z,getURI:ba,getSourceURIs:ca,hasEmojiTag:aa,richContent:y,EMOJI_TYPE:v,EMOTE_TYPE:w};},null);
__d('MercuryTypingReceiver',['Arbiter','ChannelConstants','FBID','MercuryActionType','MercuryIDs','MercuryPayloadSource','MercuryDispatcher','MercurySingletonMixin','MercuryViewer','TypingStates','isEmpty','mixInEventEmitter','setTimeoutAcrossTransitions','MercuryThreadIDMap'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(c.__markCompiled)c.__markCompiled();var u=c('MercuryThreadIDMap').get(),v=30000;function w(x){'use strict';this.$MercuryTypingReceiver1=null;this.$MercuryTypingReceiver2={};this.$MercuryTypingReceiver3=n.getForFBID(x);this.$MercuryTypingReceiver3.subscribe('update-typing-state',(function(z,aa){var ba=aa.payload_source;if(ba!=m.CLIENT_CHANNEL_MESSAGE)return;var ca=aa.actions;if(!ca||!ca.length)return;var da=k.USER_GENERATED_MESSAGE;ca.forEach((function(ea){if(ea.action_type==da&&ea.author!=p.getID())this.$MercuryTypingReceiver4(ea.thread_id,ea.author);}).bind(this));}).bind(this));var y;if(j.isUser(x)){y=[i.getArbiterType('typ'),i.getArbiterType('ttyp')];}else y=[i.getArbiterType('page_typing')];h.subscribe(y,(function(z,aa){var ba=aa.obj,ca=this.$MercuryTypingReceiver5(ba);if(ca){var da=l.getParticipantIDFromUserID(ba.from);if(ba.st==q.TYPING){this.$MercuryTypingReceiver2[ca]=this.$MercuryTypingReceiver2[ca]||{};var ea=this.$MercuryTypingReceiver2[ca][da];this.$MercuryTypingReceiver2[ca][da]=Date.now();if(!this.$MercuryTypingReceiver1)this.$MercuryTypingReceiver1=t((function(){this.$MercuryTypingReceiver6();}).bind(this),3000);!ea&&this.$MercuryTypingReceiver7(ca);}else if(ba.st==q.INACTIVE)this.$MercuryTypingReceiver4(ca,da);}}).bind(this));}w.prototype.$MercuryTypingReceiver8=function(x){'use strict';var y=this.$MercuryTypingReceiver2[x]||{},z=Object.keys(y);z.sort(function(aa,ba){return y[aa]-y[ba];});return z;};w.prototype.$MercuryTypingReceiver6=function(){'use strict';this.$MercuryTypingReceiver1=null;var x=Date.now(),y={},z=false;for(var aa in this.$MercuryTypingReceiver2){var ba=false;for(var ca in this.$MercuryTypingReceiver2[aa]||{})if(this.$MercuryTypingReceiver2[aa][ca]<x-v){delete this.$MercuryTypingReceiver2[aa][ca];ba=true;}else z=true;if(ba)y[aa]=this.$MercuryTypingReceiver8(aa);}if(!r(y))this.$MercuryTypingReceiver9(y);if(z)this.$MercuryTypingReceiver1=t((function(){this.$MercuryTypingReceiver6();}).bind(this),3000);};w.prototype.$MercuryTypingReceiver4=function(x,y){'use strict';if(x in this.$MercuryTypingReceiver2)if(y in this.$MercuryTypingReceiver2[x]){delete this.$MercuryTypingReceiver2[x][y];this.$MercuryTypingReceiver7(x);}};w.prototype.$MercuryTypingReceiver9=function(x){'use strict';this.releaseHeldEventType('state-changed');this.emitAndHold('state-changed',x);};w.prototype.$MercuryTypingReceiver7=function(x){'use strict';var y={};y[x]=this.$MercuryTypingReceiver8(x);this.$MercuryTypingReceiver9(y);};w.prototype.$MercuryTypingReceiver5=function(x){'use strict';if(x.thread_fbid)return u.getClientIDFromServerIDNow(x.thread_fbid.toString());if(x.type==='typ'||x.type==='page_typing')return l.getThreadIDFromUserID(x.from);return null;};s(w,{'state-changed':true});Object.assign(w,o);f.exports=w;},null);
__d('MercuryIndicatorController',['ArbiterMixin','DOM','MercuryActionType','MercuryDelayedRoger','MercuryIDs','MercuryMessageSourceTags','MercuryParticipants','MercuryViewer','WorkModeConfig','arrayContains','formatDate','removeFromArray','fbt','MercuryRoger','MercuryThreads','MercuryTypingReceiver'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(c.__markCompiled)c.__markCompiled();var u=c('MercuryRoger').get(),v=c('MercuryThreads').get(),w=c('MercuryTypingReceiver').get(),x=[];function y(z){this._threadID=z;this._canonicalUser=l.getUserIDFromThreadID(z);x.push(this);}Object.assign(y.prototype,h,{destroy:function(){s(x,this);},setLastMessage:function(z){this._lastMsg=z;this._handleStateChange();},_informStateChanged:function(z){if(z.activity=='none'&&this._currentActivity=='none')return;if(this._lastMsg&&o.isViewer(this._lastMsg.author))z.self_authored=true;this._currentActivity=z.activity;this.inform('state-changed',z);},_notifySentFrom:function(){var z,aa,ba=this._lastMsg.source_tags||[];if(q(ba,m.MESSENGER)){if(!p.is_work_user){z=i.create('a',{href:'/mobile/messenger','class':'fcg',target:'_blank'},t._("Sent from Messenger"));}else z=i.create('a',{href:'/mobile','class':'fcg',target:'_blank'},t._("Sent from Work Chat"));aa='sentFromMobile';}else if(q(ba,m.MOBILE)){z=i.create('a',{href:'/mobile','class':'fcg',target:'_blank'},t._("Sent from Mobile"));aa='sentFromMobile';}else if(q(ba,m.EMAIL)){z=t._("Sent from email");aa='sentFromEmail';}else{this._informStateChanged({activity:'none'});return;}this._informStateChanged({activity:aa,text:z});},_notifySeenTimestamp:function(z){var aa=u.getSeenTimestamp(this._threadID,z[0])*.001,ba=Date.now()*.001,ca;if(aa<ba-518400){ca='M j';}else if(aa<ba-86400){ca='D g:ia';}else ca='g:ia';this._informStateChanged({activity:'seen-timestamp',text:t._("Seen {timestamp}",[t.param('timestamp',r(aa,ca))])});},_nameNormalizer:function(z){var aa;n.getMulti(z,function(ba){function ca(ea){if(ba[ea]!==undefined&&ba[ea].short_name){return ba[ea].short_name.toLowerCase();}else return ea;}var da=z.map(ca);aa=function(ea){var fa=ca(ea),ga=da.indexOf(fa)!==da.lastIndexOf(fa);return ga?ba[ea].name:ba[ea].short_name;};});return aa;},_seenByEveryone:function(z,aa,ba){var ca=ba?ba.participants.length:0,da=z.length;if(aa.author!=o.getID()&&(!ba||ba.participants.indexOf(aa.author)>-1))da++;return ca>2&&da>=ca-1;},_notifySeenBy:function(z){var aa=this._lastMsg,ba=true;n.getMulti(z,(function(ca){ba=false;if(this._lastMsg!=aa)return;var da=v.getThreadMetaNow(this._threadID),ea=null;if(da&&da.custom_nickname)ea=da.custom_nickname;var fa=[];for(var ga in ca){var ha=ca[ga],ia=ha.short_name;if(ea&&ea[ha.fbid])ia=ea[ha.fbid];fa[ga]=ia;}var ja,ka=false;if(this._seenByEveryone(z,aa,da)){ja=t._("Seen by everyone");}else if(z.length==1){ja=t._("Seen by {user}",[t.param('user',fa[z[0]])]);}else if(z.length==2){ja=t._("Seen by {user1}, {user2}",[t.param('user1',fa[z[0]]),t.param('user2',fa[z[1]])]);}else if(z.length==3){ja=t._("Seen by {user1}, {user2}, {user3}",[t.param('user1',fa[z[0]]),t.param('user2',fa[z[1]]),t.param('user3',fa[z[2]])]);}else if(z.length>3){var la=Object.keys(ca).length-2,ma=t._({"*":"{num} more"},[t.param('num',la,[0])]),na=i.create('span',{className:'more'},ma);ja=t._("Seen by {user1}, {user2}, {=num more link}",[t.param('user1',fa[z[0]]),t.param('user2',fa[z[1]]),t.param('=num more link',na)]);ka=true;}this._informStateChanged({activity:'seen-by',text:ja,seenBy:z,tooltip:ka});}).bind(this));ba&&this._informStateChanged({activity:'none'});},_notifyTyping:function(z){var aa=this._lastMsg,ba=true;n.getMulti(z,(function(ca){ba=false;if(this._lastMsg!=aa)return;var da=v.getThreadMetaNow(this._threadID),ea=da?da.participants.length:0,fa;if(da)fa=this._nameNormalizer(da.participants);if(!fa)fa=function(la){return ca[la].short_name;};var ga,ha=false;if(ea>2&&z.length>=ea-1){ga=t._("Everyone is typing...");}else if(z.length==1){ga=t._("{name} is typing...",[t.param('name',ca[z[0]].short_name)]);}else if(z.length==2){ga=t._("{user1} and {user2} are typing...",[t.param('user1',ca[z[0]].short_name),t.param('user2',ca[z[1]].short_name)]);}else if(z.length==3){ga=t._("{user1}, {user2}, and {user3} are typing...",[t.param('user1',ca[z[0]].short_name),t.param('user2',ca[z[1]].short_name),t.param('user3',ca[z[2]].short_name)]);}else if(z.length>3){var ia=Object.keys(ca).length-2,ja=t._({"*":"{num} more"},[t.param('num',ia,[0])]),ka=i.create('a',{href:'#'},ja);ga=t._("{user1}, {user2}, and {=num more link} are typing...",[t.param('user1',ca[z[0]].short_name),t.param('user2',ca[z[1]].short_name),t.param('=num more link',ka)]);ha=true;}this._informStateChanged({activity:'typing',text:ga,typing:z,tooltip:ha});}).bind(this));ba&&this._informStateChanged({activity:'none'});},_handleStateChange:function(){var z=j.LOG_MESSAGE;if(!this._lastMsg||this._lastMsg.action_type==z){this._informStateChanged({activity:'none'});return;}if(this._typing&&this._typing.length){this._notifyTyping(this._typing);return;}if(this._canonicalUser&&this._lastMsg.author!=o.getID()){this._notifySentFrom();return;}var aa=k.getSeenBy(this._threadID,true);if(aa.length)if(this._canonicalUser){this._notifySeenTimestamp(aa);return;}else{this._notifySeenBy(aa);return;}this._informStateChanged({activity:'none'});}});w.addRetroactiveListener('state-changed',function(z){x.forEach(function(aa){var ba=z[aa._threadID];if(ba!==undefined){aa._typing=ba;aa._handleStateChange();}});});k.subscribe('state-changed',function(z,aa){x.forEach(function(ba){aa[ba._threadID]&&ba._handleStateChange();});});f.exports=y;},null);
__d('MercuryLastMessageIndicator.react',['DOM','MercuryIndicatorController','MercuryParticipants','React','ReactDOM','TooltipData','cx','emptyFunction','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q=k.PropTypes,r=k.createClass({displayName:'MercuryLastMessageIndicator',propTypes:{hideTyping:q.bool,indicatorWillShow:q.func,indicatorDidShow:q.func,lastMessage:q.object,threadID:q.string.isRequired},getDefaultProps:function(){return {indicatorWillShow:o,indicatorDidShow:o};},getInitialState:function(){return {data:{}};},componentDidMount:function(){this._setup(this.props);},componentWillReceiveProps:function(s){if(s.threadID!=this.props.threadID){this._destroy();this._setup(s);}else if(s.lastMessage!=this.props.lastMessage)this._controller.setLastMessage(s.lastMessage);},componentWillUpdate:function(s,t){if(this.isVisible(s,t))this.props.indicatorWillShow();},componentDidUpdate:function(){if(!this.isVisible())return;this.setText();this.setTooltip();this.props.indicatorDidShow();},componentWillUnmount:function(){this._destroy();},render:function(){return (k.createElement('div',{className:this.getRootClass()},k.createElement('div',{className:"_510h"}),k.createElement('span',{className:"_510f",ref:'text'},' ')));},getRootClass:function(){var s="_510g"+(this.state.data.self_authored?' '+"_510e":''),t=this.state.data.activity,u=null;if(String(t).startsWith('seen')){u='seen';}else if(t=='typing'){u=this.props.hideTyping?null:t;}else u=t;return p(s,u,this.props.className);},isVisible:function(s,t){s=s||this.props;t=t||this.state;return (t.data&&t.data.activity!='none'&&!(s.hideTyping&&t.data.activity=='typing'));},setText:function(){if(this.state.data.text)h.setContent(l.findDOMNode(this.refs.text),this.state.data.text);},setTooltip:function(){if(this.state.data.activity=='seen-by'&&this.state.data.tooltip)j.getMulti(this.state.data.seenBy,(function(s){var t=h.create('div',null,this.state.data.seenBy.map(function(u){return h.create('div',null,s[u].name);}));m.set(h.find(l.findDOMNode(this),'span.more'),t,'above','center');}).bind(this));},_setup:function(s){this._controller=new i(s.threadID);this._subscription=this._controller.subscribe('state-changed',(function(t,u){return this.setState({data:u});}).bind(this));s.lastMessage&&this._controller.setLastMessage(s.lastMessage);},_destroy:function(){this._subscription.unsubscribe();this._controller.destroy();}});f.exports=r;},null);
__d('WebMessengerDeleteThreadDialog',['React','SimpleXUIDialog','XUIDialogButton.react','XUIDialogCancelButton.react','fbt','MercuryThreadActions'],function a(b,c,d,e,f,g,h,i,j,k,l){if(c.__markCompiled)c.__markCompiled();var m=c('MercuryThreadActions').get(),n={show:function(o){var p=l._("Delete This Entire Conversation?"),q=l._("Once you delete your copy of this conversation, it cannot be undone."),r=h.createElement('div',null,h.createElement(k,null),h.createElement(j,{action:'cancel',label:l._("Delete Conversation"),use:'confirm',onClick:function(){return m['delete'](o);}}));i.showEx(q,p,r);}};f.exports=n;},null);
__d('WebMessengerThreadPermalinks',['MercuryIDs','MessagingTag','URI','WebMessengerPermalinkConstants','WWWBase','requireWeak'],function a(b,c,d,e,f,g,h,i,j,k,l,m){'use strict';if(c.__markCompiled)c.__markCompiled();var n={getThreadURI:function(r,s,t){if(h.isCanonical(r)){o(r,s,t);}else p(r,s,t);}};function o(r,s,t){var u=new j(l.uri),v=h.tokenize(r).value;u.setPath(q(t)+'/'+v);s&&s(u.toString());}function p(r,s,t){m('MercuryThreadIDMap',function(u){var v=u.get();v.getServerIDFromClientID(r,function(w){var x=new j(l.uri);x.setPath(k.getURIPathForThreadID(w,q(t)));s&&s(x.toString());});});}function q(r){var s=k.BASE_PATH;if(r&&r!=i.INBOX)s+='/'+r;return s;}f.exports=n;},null);
__d('MercuryTypeaheadDataSource',['Banzai','BanzaiLogger','CurrentUser','DataSource','MercuryConfig','MercuryParticipantTypes','MercuryTypeaheadConstants','OrderedFriendsList','ShortProfiles','WorkModeConfig','debounce'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){if(c.__markCompiled)c.__markCompiled();var s,t,u=500,v=[],w={},x={},y={},z=false,aa=false;s=babelHelpers.inherits(ba,k);t=s&&s.prototype;function ba(ca){'use strict';ca=ca||{};ca.kanaNormalization=true;t.constructor.call(this,ca);this.logQuery=r(function(da){this.$MercuryTypeaheadDataSource1(da);},u,this,true);this.logResponse=r(function(da){this.$MercuryTypeaheadDataSource1(da);},u,this,true);}ba.prototype.dirty=function(){'use strict';this.$MercuryTypeaheadDataSource2=v;this.localCache=x;this.queryCache=w;this.queryIDs=y;return this;};ba.prototype.bootstrap=function(){'use strict';if(z||aa)return false;this.$MercuryTypeaheadDataSource1({event:'bootstrap_start'});aa=true;p.fetchAll().then((function(){this.updateBootstrapData();this.$MercuryTypeaheadDataSource1({event:'bootstrap_end'});aa=false;z=true;}).bind(this),(function(){this.$MercuryTypeaheadDataSource1({event:'bootstrap_failure'});}).bind(this));return true;};ba.prototype.updateBootstrapData=function(){'use strict';var ca=this.getCachedShortProfileIDs(),da=q.is_work_user?m.FB4C:m.FRIEND,ea=ca.map(function(fa){var ga=p.getNow(fa),ha=fa==j.getID()?da:ga.type,ia=[ga.additionalName,ga.alternateName].concat(ga.searchTokens||[]).join(' '),ja=ga.name,ka=null;if(ga.threadNickname){ja=ga.threadNickname;ka=ga.name;}return {uid:fa,index:o.getActiveRank(fa),text:ja,subtext:ka,tokens:ia,localized_text:ga.name,additional_text:ga.additionalName,photo:ga.thumbSrc,render_type:ha,type:n.USER_TYPE};});if(ea.length)this.addEntries(ea);};ba.prototype.query=function(ca,da,ea,fa){'use strict';var ga=da||ca.length===1;return t.query.call(this,ca,ga,ea,fa);};ba.prototype.getQueryData=function(ca,da){'use strict';return babelHelpers._extends({},t.getQueryData.call(this,ca,da));};ba.prototype.setEntry=function(ca,da){'use strict';this.$MercuryTypeaheadDataSource2[ca]=da;};ba.prototype.getEntry=function(ca){'use strict';return this.$MercuryTypeaheadDataSource2[ca]||null;};ba.prototype.getCachedShortProfileIDs=function(){'use strict';var ca=p.getCachedProfileIDs(),da=ca.filter(function(ea){var fa=p.getNow(ea);return (ea==j.getID()||fa.type===m.FRIEND||fa.type===m.FB4C||fa.type===m.PAGE&&l.LinkedAgents&&l.LinkedAgents.indexOf(ea.toString())>-1);});return da;};ba.prototype.isBootstrapped=function(){'use strict';return z;};ba.prototype.isBootstrapping=function(){'use strict';return aa;};ba.prototype.processEntries=function(ca,da){'use strict';ca=ca.map(function(ea){if(ea.index==null&&(ea.render_type===m.FRIEND||ea.render_type===m.FB4C))ea.index=o.getActiveRank(ea.uid);if(ea.render_type===m.PAGE&&l.LinkedAgents&&l.LinkedAgents.indexOf(ea.uid.toString())>-1)ea.index=1;return ea;});return t.processEntries.call(this,ca);};ba.prototype.mergeUids=function(ca,da,ea,fa){'use strict';var ga=da.sort((function(ha,ia){return this.getEntry(ha).index-this.getEntry(ia).index;}).bind(this));return t.mergeUids.call(this,ca,ga,ea,fa);};ba.prototype.$MercuryTypeaheadDataSource1=function(ca){'use strict';if(!h.isEnabled('mercury_typeahead_logging'))return;i.log('MercuryQueryResultsLoggerConfig',ca);};f.exports=ba;},null);
__d('PhotoStore',['Arbiter','PhotoStoreCore'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();h.subscribe('update-photos',function(j,k){i.updateData(k);});f.exports=i;},null);
__d('MessagesViewer',['AsyncRequest','Bootloader','DOM','MessagesViewerSetID','PhotoStore','React','ReactDOM','Run','emptyFunction','ge'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){if(c.__markCompiled)c.__markCompiled();var r={bootstrapWithElem:function(u){r.bootstrapWithConfig({fbid:u.getAttribute('data-fbid'),dimensions:u.getAttribute('data-dimensions'),src:u.getAttribute('href'),endpoint:u.getAttribute('data-endpoint'),disablePaging:u.getAttribute('data-disablepaging')},u);},bootstrapWithConfig:function(u,v){var w=u.setID;if(!w)w=k.MESSAGES;t(function(x,y){s(m.createElement(x,{actorid:u.actorid,dimensions:[u.dimensions],disablepaging:u.disablePaging,disableForward:u.disableForward,open:true,photoid:u.fbid,reverse:false,rootClassName:u.rootClassName,setid:w,snapToPhoto:u.snapToPhoto,thumbsrc:u.src}));if(!l.hasBeenCreated(w)&&u.endpoint){var z=new h(u.endpoint);if(v)z.setRelativeTo(v);z.send();}});},renderVideo:function(u){t(function(v,w){s(m.createElement(w,u));});},preload:function(){o.onAfterLoad(function(){return t(p);});}};function s(u){var v=q('messages_viewer');if(!v){v=j.create('div',{id:'messages_viewer'});document.body.appendChild(v);}u=n.render(u,v);u.subscribeOnce('close',function(){n.unmountComponentAtNode(v);});}function t(u){i.loadModules(["SpotlightMessagesViewer","MessagingVideoViewer.react"],u);}f.exports=r;},null);
__d('MercuryLogMessageRenderer',['BootloadedComponent.react','Bootloader','CSS','HovercardLink','JSResource','MercuryIDs','MercuryViewer','MessagesViewer','MercuryLogMessageType','MessagingGenericAdminTextType','MercuryParticipants','React','ReactDOM','Image.react','TextWithEntities.react','TooltipLink.react','UserAgent','cx','fbt','ix'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa){if(c.__markCompiled)c.__markCompiled();var ba={renderText:function(qa,ra){switch(qa.log_message_type){case p.SUBSCRIBE:ea(qa,ra);break;case p.UNSUBSCRIBE:ja(qa,ra);break;case p.THREAD_NAME:ka(qa,ra);break;case p.THREAD_IMAGE:la(qa,ra);break;case p.WALLPAPER:ma(qa,ra);break;case p.GENERIC_ADMIN_TEXT:na(qa,ra);break;default:i.loadModules(["MercurySpecialLogMessageRenderer"],function(sa){sa.renderText(qa,ra);});break;}},renderIcon:function(qa){return (s.createElement(u,{className:ca(qa),src:aa('images/spacer.gif')}));},renderLegacy:function(qa,ra,sa,ta){ca(ta).split(' ').forEach(function(ua){return ua&&j.addClass(qa,ua);});this.renderText(ta,function(ua){t.render(s.createElement('span',null,ua),ra);});this.renderAttachmentLegacy(sa,ta);},renderAttachmentLegacy:function(qa,ra){if(ra.log_message_type==p.THREAD_IMAGE){var sa=ra.log_message_data.image;if(sa&&sa.preview_url){t.render(s.createElement(u,{className:"_z6a",onClick:function(){return da(sa);},src:sa.preview_url}),qa);j.show(qa);}}}};f.exports=ba;function ca(qa){var ra=qa.log_message_type,sa=qa.log_message_data;return "_5wzu"+(ra==p.SUBSCRIBE?' '+"_5wzj":'')+(ra==p.UNSUBSCRIBE?' '+"_5wzk":'')+(ra==p.THREAD_NAME?' '+"_5wzl":'')+(ra==p.THREAD_IMAGE?' '+"_5wzm":'')+(ra==p.VIDEO_CALL&&sa.answered?' '+"_5wzn":'')+(ra==p.VIDEO_CALL&&!sa.answered?' '+"_5wzo":'')+(ra==p.PHONE_CALL&&sa.answered?' '+"_5wzp":'')+(ra==p.PHONE_CALL&&!sa.answered?' '+"_5wzq":'')+(ra==p.SERVER_ERROR?' '+"_5wzr":'');}function da(qa){o.bootstrapWithConfig({src:qa.preview_url,endpoint:qa.url,fbid:qa.metadata.fbid,dimensions:qa.metadata.dimensions,disablePaging:true},null);}function ea(qa,ra){var sa=pa(qa.log_message_data.added_participants);switch(sa.length){case 1:fa(qa,ra,sa);break;case 2:ga(qa,ra,sa);break;case 3:ha(qa,ra,sa);break;default:ia(qa,ra,sa);break;}}function fa(qa,ra,sa){var ta=[qa.author,sa[0]];r.getMulti(ta,function(ua){if(qa.author==n.getID()){ra(z._("You added {subscriber1}.",[z.param('subscriber1',oa(ua[sa[0]]))]));}else if(sa[0]==n.getID()){ra(z._("{actor} added you.",[z.param('actor',oa(ua[qa.author]))]));}else ra(z._("{actor} added {subscriber1}.",[z.param('actor',oa(ua[qa.author])),z.param('subscriber1',oa(ua[sa[0]]))]));});}function ga(qa,ra,sa){var ta=[qa.author].concat(sa);r.getMulti(ta,function(ua){if(qa.author==n.getID()){ra(z._("You added {subscriber1} and {subscriber2}.",[z.param('subscriber1',oa(ua[sa[0]])),z.param('subscriber2',oa(ua[sa[1]]))]));}else if(sa[0]==n.getID()){ra(z._("{actor} added you and {subscriber2}.",[z.param('actor',oa(ua[qa.author])),z.param('subscriber2',oa(ua[sa[1]]))]));}else ra(z._("{actor} added {subscriber1} and {subscriber2}.",[z.param('actor',oa(ua[qa.author])),z.param('subscriber1',oa(ua[sa[0]])),z.param('subscriber2',oa(ua[sa[1]]))]));});}function ha(qa,ra,sa){var ta=[qa.author].concat(sa);r.getMulti(ta,function(ua){if(qa.author==n.getID()){ra(z._("You added {subscriber1}, {subscriber2} and {subscriber3}.",[z.param('subscriber1',oa(ua[sa[0]])),z.param('subscriber2',oa(ua[sa[1]])),z.param('subscriber3',oa(ua[sa[2]]))]));}else if(sa[0]==n.getID()){ra(z._("{actor} added you, {subscriber2} and {subscriber3}.",[z.param('actor',oa(ua[qa.author])),z.param('subscriber2',oa(ua[sa[1]])),z.param('subscriber3',oa(ua[sa[2]]))]));}else ra(z._("{actor} added {subscriber1}, {subscriber2} and {subscriber3}.",[z.param('actor',oa(ua[qa.author])),z.param('subscriber1',oa(ua[sa[0]])),z.param('subscriber2',oa(ua[sa[1]])),z.param('subscriber3',oa(ua[sa[2]]))]));});}function ia(qa,ra,sa){var ta=[qa.author].concat(sa);r.getMulti(ta,function(ua){function va(xa){var ya=s.createElement('div',null,xa.map(function(za){return s.createElement('div',null,za.name);}));return (s.createElement(w,{alignH:'center',position:'above',tooltip:ya},z._({"*":"{num} more"},[z.param('num',xa.length,[0])])));}var wa=sa.map(function(xa){return ua[xa];});if(qa.author==n.getID()){ra(z._("You added {subscriber1}, {subscriber2} and {more_people}.",[z.param('subscriber1',oa(wa[0])),z.param('subscriber2',oa(wa[1])),z.param('more_people',va(wa.slice(2)))]));}else if(sa[0]==n.getID()){ra(z._("{actor} added you, {subscriber2} and {more_people}.",[z.param('actor',oa(ua[qa.author])),z.param('subscriber2',oa(wa[1])),z.param('more_people',va(wa.slice(2)))]));}else ra(z._("{actor} added {subscriber1}, {subscriber2} and {more_people}.",[z.param('actor',oa(ua[qa.author])),z.param('subscriber1',oa(wa[0])),z.param('subscriber2',oa(wa[1])),z.param('more_people',va(wa.slice(2)))]));});}function ja(qa,ra){var sa=[qa.author],ta=qa.log_message_data.removed_participants,ua;if(ta.length===1){ua=ta[0];sa.push(ua);}r.getMulti(sa,function(va){var wa=va[qa.author],xa=va[ua];if(qa.author==n.getID()){if(!ua||ua==qa.author){ra(z._("You left the conversation."));}else ra(z._("You removed {name} from the conversation.",[z.param('name',oa(xa))]));}else if(!ua||ua==qa.author){ra(z._("{actor} left the conversation.",[z.param('actor',oa(wa))]));}else if(ua==n.getID()){ra(z._("{actor} removed you from the conversation.",[z.param('actor',oa(wa))]));}else ra(z._("{actor} removed {name} from the conversation.",[z.param('actor',oa(wa)),z.param('name',oa(xa))]));});}function ka(qa,ra){var sa=qa.log_message_data.name;if(qa.author==n.getID()){if(sa){var ta="_5wzs"+(x.isBrowser('Chrome')?' '+"_4fbd":'');ra(z._("You named the conversation: {name}.",[z.param('name',s.createElement('span',{className:ta},s.createElement(v,{renderEmoticons:true,renderEmoji:true,text:sa})))]));}else ra(z._("You removed the conversation name."));}else r.get(qa.author,function(ua){var va=oa(ua);if(sa){ra(z._("{actor} named the conversation: {name}.",[z.param('actor',va),z.param('name',s.createElement('span',{className:"_5wzs"},sa))]));}else ra(z._("{actor} removed the conversation name.",[z.param('actor',va)]));});}function la(qa,ra){if(qa.author==n.getID()){if(qa.log_message_data.image){ra(z._("You changed the conversation picture."));}else ra(z._("You removed the conversation picture."));}else r.get(qa.author,function(sa){var ta=oa(sa);if(qa.log_message_data.image){ra(z._("{actor} changed the conversation picture.",[z.param('actor',ta)]));}else ra(z._("{actor} removed the conversation picture.",[z.param('actor',ta)]));});}function ma(qa,ra){if(qa.author==n.getID()){ra(z._("You changed the wallpaper."));}else r.get(qa.author,function(sa){var ta=oa(sa);ra(z._("{actor} changed the wallpaper.",[z.param('actor',ta)]));});}function na(qa,ra){var sa=qa.log_message_body,ta=qa.log_message_data;switch(ta.message_type){case q.TURN_ON_PUSH:if(sa&&sa.length>0)sa=z._("{admin-text-message} for Messenger on mobile.",[z.param('admin-text-message',sa.substring(0,sa.length-1))]);break;case q.JOURNEY_PROMPT_COLOR:sa=z._("You need to be on the latest version of Messenger on a mobile device to pick a color for this conversation.");break;case q.JOURNEY_PROMPT_NICKNAME:var ua=null,va=m.getUserIDFromParticipantID(qa.author);if(qa.other_user_fbid&&va!==qa.other_user_fbid){var wa=m.getParticipantIDFromUserID(qa.other_user_fbid);ua=r.getOrFetch(wa);}if(ua&&ua.short_name){sa=z._("You need to be on the latest version of Messenger on a mobile device to set a nickname for {admin-text-message} .",[z.param('admin-text-message',ua.short_name)]);}else sa=z._("You need to be on the latest version of Messenger on a mobile device to set a nickname for yourself.");break;case q.JOURNEY_PROMPT_LIKE:sa=z._("You need to be on the latest version of Messenger on a mobile device to pick an emoji for this conversation.");break;default:break;}ra(sa);}function oa(qa,ra){var sa=qa.fbid,ta=k.constructEndpoint({id:sa});if(qa.href)return (s.createElement('a',{className:"_5wzt",href:qa.href,'data-hovercard':ta},ra?qa.short_name:qa.name));return qa.name;}function pa(qa){var ra=qa.indexOf(n.getID());if(ra>0){var sa=qa.filter(function(ta){return ta!==n.getID();});return [n.getID()].concat(sa);}return qa;}},null);
__d('MercuryThreadSearchUtils',['escapeRegex','TokenizeUtil'],function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j={wordsInString:function(k){return (k||'').split(/\s+/).filter(function(l){return l.trim().length>0;});},anyMatchPredicate:function(k,l){for(var m=0;m<k.length;m++)if(l(k[m]))return true;return false;},allMatchPredicate:function(k,l){for(var m=0;m<k.length;m++)if(!l(k[m]))return false;return true;},queryWordMatchesAnyNameWord:function(k,l){var m=new RegExp('^'+h(k),'i');return this.anyMatchPredicate(l,function(n){var o=i.parse(n).flatValue;return m.test(o);});},queryMatchesName:function(k,l){var m=this.wordsInString(k),n=this.wordsInString(l);return this.allMatchPredicate(m,(function(o){return this.queryWordMatchesAnyNameWord(o,n);}).bind(this));}};f.exports=j;},null);
__d('MercuryMessageGroup',['MercuryActionType','MercuryAttachmentType','MercuryShareAttachmentRenderLocations','MercuryThreadlistConstants','enumerate'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();var m={calculateMessageGroups:function(p,q){var r=[],s=null,t={value:null},u=l(p),v;while(!(v=u.next()).done){var w=m.canAppendMessageToLastGroup(t.value,v.value,q);if(!w){s=[];r.push(s);}s.push(v.value);t=v;}return r;},canAppendMessageToLastGroup:function(p,q,r){var s=k.GROUPING_THRESHOLD;if(!p||n(p,r)||n(q,r)||p.author!=q.author||p.timestamp<q.timestamp-s||p.is_spoof_warning!==q.is_spoof_warning||p.page_admin_notes)return false;return true;}};function n(p,q){var r=p.has_attachment;if(r&&(q===j.MESSENGER||q===j.CHAT))r=o(p);return !!(p.action_type==h.LOG_MESSAGE||r||p.forward_count||p.html_body||p.body&&p.body.length>k.MAX_CHARS_BEFORE_BREAK);}function o(p){var q=p.attachments[0];return (!q||q.attach_type===i.STICKER||q.attach_type===i.ANIMATED_IMAGE);}f.exports=m;},null);
__d('P2PAbstractSendMoneyButton.react',['React','TooltipLink.react','cx','fbt','joinClasses'],function a(b,c,d,e,f,g,h,i,j,k,l){'use strict';if(c.__markCompiled)c.__markCompiled();var m=h.PropTypes,n=h.createClass({displayName:'P2PAbstractSendMoneyButton',propTypes:{button:m.object,isActive:m.bool.isRequired,isDisabled:m.bool,isMessenger:m.bool.isRequired,onClick:m.func.isRequired,onMouseOver:m.func,recipientName:m.string},_clickGuard:false,render:function(){return (h.createElement(i,{alignH:'center',className:l(this.props.className,(this.props.isActive?"open":'')+(this.props.isDisabled?' '+"disabled":'')+(this.props.isActive?' '+"_10gz":'')+(this.props.isDisabled?' '+"_10g-":'')+(!this.props.isMessenger&&!this.props.className?' '+"_5uqy":'')+(this.props.isMessenger?' '+"_3ggc":'')),href:'#',onClick:this._handleClick,onMouseDown:this._prepareForClick,onMouseOver:this.props.onMouseOver,position:'above',role:'button',title:this._getLinkTitle()},this.getButton()));},getButton:function(){if(this.props.button)return this.props.button;return h.createElement('i',{className:"_5s8l"});},_getLinkTitle:function(){if(this.props.isDisabled)return null;return k._("Send Money");},_prepareForClick:function(){this._clickGuard=this.props.isActive;},_handleClick:function(o){o.stopPropagation();if(this._clickGuard){this._clickGuard=false;return;}this.props.onClick();}});f.exports=n;},null);
__d('P2PLogger',['BanzaiLogger'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i='P2PPaymentLoggerConfig',j={log:function(k,l){l=babelHelpers._extends({event:k},l);h.log(i,l);}};f.exports=j;},null);
__d('P2PSendMoneyContainerBootloader.react',['Bootloader','CurrentEnvironment','DeferredComponent.react','MercuryIDs','P2PAbstractSendMoneyButton.react','P2PLogger','P2PPaymentLoggerEvent','P2PPaymentLoggerEventFlow','React','Run','emptyFunction'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){'use strict';if(c.__markCompiled)c.__markCompiled();var s=p.PropTypes,t=i.messengerdotcom,u=p.createClass({displayName:'P2PSendMoneyContainerBootloader',propTypes:{button:s.node,className:s.string,flyoutAlignment:s.string,onTrigger:s.func,participantIDs:s.array,referrer:s.string,threadID:s.string},log:function(x,y){m.log(x,babelHelpers._extends({www_event_referrer:this.props.referrer,www_event_flow:o.UI_FLOW_P2P_SEND},y));},onPlaceholderClick:function(){var x=this.props.threadID?k.tokenize(this.props.threadID).value:null;this.log(n.UI_ACTN_SEND_MONEY_BUTTON_PLACEHOLDER_CLICKED,{object_id:x});},render:function(){return (p.createElement(j,babelHelpers._extends({deferredComponent:v,deferredPlaceholder:this._renderPlaceholder()},this.props)));},_renderPlaceholder:function(){return (p.createElement(l,{button:this.props.button,className:this.props.className,isActive:false,isDisabled:true,isMessenger:t,onClick:this.onPlaceholderClick,onMouseOver:w}));}});function v(x){q.onAfterLoad(function(){h.loadModules(["P2PSendMoneyContainer.react"],x);});}function w(){h.loadModules(["P2PSendMoneyContainer.react"],r);}f.exports=u;},null);
__d('StickersDispatcher',['Dispatcher_DEPRECATED','StickerConstants'],function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=Object.assign(new h(),{_handleUpdate:function(k,l){var m=babelHelpers._extends({payloadSource:k},l);this.dispatch(m);},handleUpdateFromViewActions:function(k){this._handleUpdate(i.PayloadSource.VIEW_ACTION,k);}});f.exports=j;},null);
__d('StickerActions',['BanzaiLogger','StickersDispatcher','keyMirror'],function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=j({ADD_PACK:null,CLICKED_STICKER_IN_THREAD:null,HIDE_TRAY:null,REMOVE_PACK:null,REPLACE_STICKER_STATE:null,RESET_NUM_NEW_PACKS:null,SELECT_PACK:null,SELECT_STORE_PACK:null,SHOW_TRAY:null,UPDATE_TRAY_DATA:null,TRAY_DATA_READY:null}),l={Types:k,addPack:function(m){i.dispatch({type:k.ADD_PACK,packID:m});},removePack:function(m){i.dispatch({type:k.REMOVE_PACK,packID:m});},selectPack:function(m,n){if(!n)h.log('StickersLoggerConfig',{event:'select_pack',packid:m});i.dispatch({type:k.SELECT_PACK,packID:m});},selectStorePack:function(m){i.dispatch({type:k.SELECT_STORE_PACK,packID:m});},resetNumNewPacks:function(){i.dispatch({type:k.RESET_NUM_NEW_PACKS});},handleStickerClick:function(m,n){i.dispatch({packID:m,threadID:n,type:l.Types.CLICKED_STICKER_IN_THREAD});},showStickerTray:function(m){i.dispatch({type:l.Types.SHOW_TRAY,threadID:m});},hideStickerTray:function(){i.dispatch({type:l.Types.HIDE_TRAY});},updateTrayData:function(){i.dispatch({type:l.Types.UPDATE_TRAY_DATA});},loadedTrayData:function(){i.dispatch({type:l.Types.TRAY_DATA_READY});}};f.exports=l;},null);
__d("XStickerPackImagesController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/{pack_id}\/images\/",{pack_id:{type:"Int",required:true},sticker_size:{type:"Int",defaultValue:50}});},null);
__d("XStickerQueryImagesController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/query\/images\/",{query:{type:"String",required:true},sticker_interface:{type:"String"}});},null);
__d("XStickerStateInitialDataController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/state\/",{});},null);
__d("XStickerStatePackDataController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/state\/pack\/",{pack_id:{type:"Int",required:true}});},null);
__d("XStickerStateStoreDataController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/state\/store\/",{});},null);
__d("XStickersAddPackController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/addpack\/",{pack_id:{type:"Int"},size:{type:"String"},redirect_uri:{type:"String"},is_promoted:{type:"Bool",defaultValue:false},no_async_dom:{type:"Bool",defaultValue:false}});},null);
__d("XStickersRemovePackController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/stickers\/removepack\/",{pack_id:{type:"Int"},size:{type:"String"},redirect_uri:{type:"String"},no_async_dom:{type:"Bool",defaultValue:false}});},null);
__d('StickerServerRequests',['Promise','AsyncRequest','XStickerPackImagesController','XStickersAddPackController','XStickersRemovePackController','XStickerStateInitialDataController','XStickerStatePackDataController','XStickerStateStoreDataController','XStickerQueryImagesController'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){'use strict';if(c.__markCompiled)c.__markCompiled();var q={addPack:function(s,t,u){var v=k.getURIBuilder().setInt('pack_id',s).setBool('is_promoted',t).getURI();new i(v).setHandler(function(w){return u(w.payload);}).send();},removePack:function(s,t){var u=l.getURIBuilder().setInt('pack_id',s).getURI();new i(u).setHandler(function(v){return t(v.payload);}).send();},getStickersForPack:function(s,t){var u=j.getURIBuilder().setInt('pack_id',s).setInt('sticker_size',t).getURI();return new h(function(v,w){return (new i().setURI(u).setMethod('GET').setReadOnly(true).setHandler(function(x){return v(x.payload);}).send());});},getStickersForQuery:function(s,t,u){new i().setURI(p.getURIBuilder().setString('query',s).setString('sticker_interface',t).getURI()).setMethod('GET').setReadOnly(true).setHandler(function(v){return u(v);}).send();},fetchTrayData:function(s){return r(m.getURIBuilder().getURI(),s,true);},fetchStoreData:function(s){return r(o.getURIBuilder().getURI(),s);},fetchPackData:function(s,t){return r(n.getURIBuilder().setInt('pack_id',s).getURI(),t);}};function r(s,t,u){return new h(function(v,w){return (new i(s).setHandler(function(x){return v(x.getPayload());}).setAllowCrossPageTransition(u).send());}).then(t);}f.exports=q;},null);
__d('StickerImages',['StickerServerRequests'],function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i={},j={},k={requestStickersForPack:function(l,m,n){if(!l)return;if(!j[l]){j[l]=h.getStickersForPack(l,m);j[l].then((function(o){o.forEach((function(p){return this.cacheSticker(p);}).bind(this));}).bind(this));}j[l].then(function(o){return n(o);});},cacheSticker:function(l){i[l.id]=l;},getSticker:function(l){return i[l];}};f.exports=k;},null);
__d('StickerState',['ImmutableObject','StickerConfig','PresenceState','StickerActions','StickerConstants','StickerImages','StickerServerRequests'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){'use strict';if(c.__markCompiled)c.__markCompiled();var o={},p,q,r,s=null,t=0,u={},v=[],w=[],x=[],y=null,z=null,aa=j.get();if(aa)y=aa.tray_pack_id;var ba=i.ShowStickerReplyNUX,ca={onTrayDataReady:function(ea){if(!q)q=n.fetchTrayData(function(fa){v=fa.packs.map(function(ga){return da(ga);});r=fa.mru;t=fa.num_new_packs;x=fa.tags;});q.then(function(){ea();k.loadedTrayData();});},onStoreDataReady:function(ea){if(!p)p=n.fetchStoreData(function(fa){w=fa.packs.map(function(ga){return da(ga);});});p.then(ea);},onPackDataReady:function(ea,fa){if(!o[ea])o[ea]=n.fetchPackData(ea,function(ga){da(ga);});o[ea].then(fa);},getPacksInTrayAllInterfaces:function(){return v;},getPacksInTray:function(){var ea=[],fa;for(var ga=0;ga<v.length;ga++)if(v[ga].id==l.EMOTICON_PACK_ID){fa=v[ga];}else if(v[ga].isMessengerCapable)ea.push(v[ga]);fa&&ea.push(fa);return ea;},getPacksInCommentsTray:function(){var ea=[],fa=[],ga;for(var ha=0;ha<v.length;ha++)if(v[ha].id==l.EMOTICON_PACK_ID){ga=v[ha];}else if(v[ha].isCommentsCapable){ea.push(v[ha]);}else fa.push(v[ha]);var ia=ea.concat(fa);if(ga)ia.push(ga);return ia;},getPacksInComposerTray:function(){return v.filter(function(ea){return ea.isComposerCapable;});},getPacksInFramesTray:function(){return v.filter(function(ea){return ea.isFramePack;});},getPackIDsInTray:function(){return v.map(function(ea){return ea.id;});},getPacksInStore:function(){return w.filter(function(ea){return ea.isMessengerCapable;});},getComposerPacksInStore:function(){return w.filter(function(ea){return ea.isComposerCapable;});},getPack:function(ea){return u[ea];},getNumNewPacks:function(){return t;},getFeaturedTags:function(){return x;},resetNumNewPacks:function(){t=0;},addMRUPack:function(){if(r){this._addPackToTray(r);r=null;}},addPack:function(ea){var fa=false;if(u[ea])fa=u[ea].isPromoted;n.addPack(ea,fa,(function(ga){this._addPackToTray(ga);}).bind(this));},removePack:function(ea){n.removePack(ea,function(fa){v=v.filter(function(ga){return ga.id!==fa;});u[fa]=h.set(u[fa],{isInTray:false});w=w.map(function(ga){return u[ga.id];});k.updateTrayData();});},setTrayPackID:function(ea){y=ea;j.doSync();},getTrayPackID:function(ea){if(ea&&ea.length>0&&!ea.some(function(fa){return fa.id===y;})){return ea[0].id;}else return y;},setStorePackID:function(ea){z=ea;},getStorePackID:function(){return z;},shouldShowStickerReplyNUX:function(){return ba;},clearShowStickerReplyNUX:function(){ba=false;},_addPackToTray:function(ea,fa){da(ea);u[ea.id]=h.set(u[ea.id],{isPurchased:!fa,isInTray:true});var ga=v.filter(function(ia){return ia.id===ea.id;}).length>0;if(!ga){var ha;if(!fa){ha=v.filter(function(ia){return ia.isMRU||ia.isSearch;}).length;}else ha=v.filter(function(ia){return ia.id!==l.EMOTICON_PACK_ID;}).length;v.splice(ha,0,u[ea.id]);}w=w.map(function(ia){return u[ia.id];});k.updateTrayData();},_addRecentlyUsedSticker:function(ea){for(var fa=0;fa<s.length;++fa)if(s[fa].id===ea.id){s.splice(fa,1);break;}s.unshift(ea);},getMRUStickerPack:function(ea){if(!s)s=ea;return s;},updateRecentlyUsed:function(ea){if(!s){this.addMRUPack();return;}this._addRecentlyUsedSticker(m.getSticker(ea));}};j.registerStateStorer(function(ea){ea.tray_pack_id=y;});function da(ea){var fa=ea.id;if(!u[fa]){return u[fa]=new h(ea);}else return u[fa]=h.set(u[fa],ea);}f.exports=ca;},null);
__d('AbstractDialogFitHeight',['CSS','DOM','Event','Style','SubscriptionsHandler','Vector','csx','cx','throttle'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){if(c.__markCompiled)c.__markCompiled();var q=450,r=100,s=67,t=67;function u(v){'use strict';this.$AbstractDialogFitHeight1=v;}u.prototype.enable=function(){'use strict';this.$AbstractDialogFitHeight2=new l();this.$AbstractDialogFitHeight2.addSubscriptions(this.$AbstractDialogFitHeight1.subscribe('beforeshow',this.$AbstractDialogFitHeight3.bind(this)),j.listen(window,'resize',p(this.$AbstractDialogFitHeight3.bind(this))));this.$AbstractDialogFitHeight4=i.find(this.$AbstractDialogFitHeight1.getRoot(),"._4-i2");h.addClass(this.$AbstractDialogFitHeight4,"_5pfh");this.$AbstractDialogFitHeight5=r;if(i.scry(this.$AbstractDialogFitHeight1.getRoot(),"._4-i0").length)this.$AbstractDialogFitHeight5+=s;if(i.scry(this.$AbstractDialogFitHeight1.getRoot(),"._5a8u").length)this.$AbstractDialogFitHeight5+=t;};u.prototype.disable=function(){'use strict';this.$AbstractDialogFitHeight2.release();this.$AbstractDialogFitHeight2=null;h.removeClass(this.$AbstractDialogFitHeight4,"_5pfh");};u.prototype.$AbstractDialogFitHeight3=function(){'use strict';var v=m.getViewportDimensions().y,w=v-this.$AbstractDialogFitHeight5;k.set(this.$AbstractDialogFitHeight4,this.getHeightProperty(),Math.max(q,w)+'px');this.$AbstractDialogFitHeight1.updatePosition();};f.exports=u;},null);
__d('DialogFitHeight',['AbstractDialogFitHeight'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i,j;i=babelHelpers.inherits(k,h);j=i&&i.prototype;k.prototype.getHeightProperty=function(){'use strict';return 'height';};function k(){'use strict';i.apply(this,arguments);}f.exports=k;},null);
__d('StickerStoreController',['Bootloader','DialogFitHeight','DOM','LayerAutoFocus','LayerFadeOnHide','LayerHideOnEscape','React','ReactComponentRenderer','StickerActions','XUIDialog.react','XUIDialogBody.react','XUISpinner.react','cx','isSocialPlugin','requestAnimationFrame'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){'use strict';if(c.__markCompiled)c.__markCompiled();var w=n.PropTypes,x=688,y=320,z=null,aa=n.createClass({displayName:'StoreLayer',propTypes:{isComposer:w.bool,shown:w.bool},getDefaultProps:function(){return {isComposer:false,shown:false};},getInitialState:function(){return {renderStore:function(){return (n.createElement('div',{className:"_5r5e"},n.createElement(s,{background:'light',size:'large'})));}};},componentDidMount:function(){h.loadModules(["StickerStore.react"],(function(da){this.setState({renderStore:(function(){return (n.createElement(da,{isComposer:this.props.isComposer,shown:this.props.shown}));}).bind(this)});}).bind(this));},_onToggle:function(da){v((function(){return this.setProps({shown:da});}).bind(this));},render:function(){var da=u()&&document.body.offsetWidth<x?y:x;return (n.createElement(q,{behaviors:{DialogFitHeight:i,LayerAutoFocus:k,LayerFadeOnHide:l,LayerHideOnEscape:m},onToggle:this._onToggle,shown:this.props.shown,width:da},n.createElement(r,{className:"_5rq- autofocus"},this.state.renderStore())));}});function ba(da){var ea=j.create('div');j.appendContent(document.body,ea);z=new o(aa,ea);z.setProps({isComposer:da,shown:true});}var ca={showStore:function(da,ea){if(!z){ba(!!ea);}else z.setProps({shown:true,isComposer:!!ea});p.selectStorePack(da);}};f.exports=ca;},null);
__d('StickerStateStore',['FluxStore','StickerActions','StickerInterfaces','StickersDispatcher','StickerState','StickerStoreController','arrayContains','emptyFunction'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p,q;'use strict';p=babelHelpers.inherits(r,h);q=p&&p.prototype;function r(){q.constructor.call(this,k);this.$StickerStateStore1=false;}r.prototype.getState=function(s){var t=null;if(s===j.COMPOSER){t=l.getPacksInComposerTray();}else if(s===j.COMMENTS){t=l.getPacksInCommentsTray();}else if(s===j.FRAMES){t=l.getPacksInFramesTray();}else t=l.getPacksInTray();return {showTray:this.$StickerStateStore2,storePackID:l.getStorePackID(),packID:l.getTrayPackID(t),trayPacks:t,numNewPacks:l.getNumNewPacks(),threadID:this.$StickerStateStore3,trayDataReady:this.$StickerStateStore1};};r.prototype.isPackInTray=function(s){if(!this.$StickerStateStore1)l.onTrayDataReady(o);var t=l.getPacksInTrayAllInterfaces();return t.some(function(u){return u.id===s;});};r.prototype.__onDispatch=function(s){var t=i.Types;switch(s.type){case t.REPLACE_STICKER_STATE:this.$StickerStateStore2=!!s.showTray;break;case t.SHOW_TRAY:this.$StickerStateStore2=true;this.$StickerStateStore3=s.threadID;break;case t.HIDE_TRAY:this.$StickerStateStore2=false;break;case t.CLICKED_STICKER_IN_THREAD:l.onTrayDataReady((function(){if(n(l.getPackIDsInTray(),s.packID)){l.setTrayPackID(s.packID);this.$StickerStateStore2=true;this.$StickerStateStore3=s.threadID;}else{this.$StickerStateStore2=false;m.showStore(s.packID);}}).bind(this));break;case t.SELECT_PACK:l.setTrayPackID(s.packID);break;case t.SELECT_STORE_PACK:l.setStorePackID(s.packID);break;case t.RESET_NUM_NEW_PACKS:l.resetNumNewPacks();break;case t.ADD_PACK:l.addPack(s.packID);break;case t.REMOVE_PACK:l.removePack(s.packID);break;case t.UPDATE_TRAY_DATA:break;case t.TRAY_DATA_READY:this.$StickerStateStore1=true;break;}this.__emitChange();};f.exports=new r();},null);
__d('legacy:CompactTypeaheadRenderer',['CompactTypeaheadRenderer'],function a(b,c,d,e){if(c.__markCompiled)c.__markCompiled();if(!b.TypeaheadRenderers)b.TypeaheadRenderers={};b.TypeaheadRenderers.compact=c('CompactTypeaheadRenderer');},3);