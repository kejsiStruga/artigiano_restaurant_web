/*!CK:777658124!*//*1453400651,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["YTrAg"]); }

__d('MessengerForwardAttachmentDialog.react',['ix','AsyncRequest','CurrentUser','Image.react','immutable','LayerFadeOnHide','MessengerComposeViewHeader.react','MessengerDialog.react','MessengerDialogBody.react','MessengerDialogButton.react','MessengerDialogCancelButton.react','MessengerDialogFooter.react','MessengerDialogHeader.react','MessengerDialogTitle.react','MessengerSpinner.react','React','XMessagingForwardAttachmentController','cx','emptyFunction','fbglyph','fbt'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba){if(c.__markCompiled)c.__markCompiled();var ca=w.PropTypes,da=w.createClass({displayName:'MessengerForwardAttachmentDialog',propTypes:{attachmentID:ca.string.isRequired,onClose:ca.func,shown:ca.bool.isRequired,title:ca.string.isRequired},getInitialState:function(){return {recipients:l.List(),sendError:null,sending:false,startingThreadingID:Date.now()};},render:function(){var ea=ba._("Send"),fa;if(this.state.sending){fa=w.createElement('div',null,w.createElement(v,null),w.createElement('span',{className:"_1e1n _3-99"},ba._("Sending")));}else if(this.state.sendError){var ga=h("\/images\/assets_DO_NOT_HARDCODE\/fb_glyphs\/caution-solid_16_bluegray-40.png");fa=w.createElement('div',{className:"_1e1n"},w.createElement(k,{src:ga}),w.createElement('span',{className:"_3-99"},this.state.sendError));}return (w.createElement(o,{shown:this.props.shown,behaviors:{LayerFadeOnHide:m},onToggle:this._handleToggle,width:560},w.createElement(t,null,w.createElement(u,null,this.props.title)),w.createElement(p,null,w.createElement(n,{className:"_1e1o",onAddRecipient:this._handleAddRecipient,onRemoveRecipient:this._handleRemoveRecipient,onResize:z,recipients:this.state.recipients,viewer:j.getID()})),w.createElement(s,{leftContent:fa},w.createElement(r,{onClick:this.props.onClose}),w.createElement(q,{action:'confirm',disabled:!this.state.recipients.size||this.state.sending,label:ea,onClick:this._handleSubmit,type:'primary'}))));},_handleAddRecipient:function(ea){this.setState({recipients:this.state.recipients.push(ea)});},_handleRemoveRecipient:function(ea){var fa=this.state.recipients;this.setState({recipients:fa['delete'](fa.indexOf(ea))});},_handleSubmit:function(){var ea={},fa=this.state.startingThreadingID;this.state.recipients.forEach(function(ha){ea[fa++]=ha.getUniqueID();});var ga=x.getURIBuilder().getURI();new i(ga).setMethod('POST').setHandler(this._handleSubmitResponse).setData({attachment_id:this.props.attachmentID,recipient_map:ea}).send();this.setState({sending:true,sendError:null});},_handleSubmitResponse:function(ea){if(ea.payload.success){this.props.onClose&&this.props.onClose();this.setState({recipients:l.List(),sending:false,startingThreadID:Date.now()});return;}this.setState({sending:false,sendError:ea.payload.error});},_handleToggle:function(ea){if(!ea)this.props.onClose&&this.props.onClose();}});f.exports=da;},null);