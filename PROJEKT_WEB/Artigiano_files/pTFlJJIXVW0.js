/*!CK:3714662316!*//*1452892014,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["doJiQ"]); }

__d("XMessagingVideoAttachmentController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/mercury\/attachments\/video\/",{video_id:{type:"String",required:true},video_container_id:{type:"String",required:true},width:{type:"Int",required:true},height:{type:"Int",required:true}});},null);
__d('MessagingVideoViewer.react',['ActorURI','ArbiterMixin','AsyncRequest','CurrentEnvironment','MessagingForwardAttachmentDialog.react','MessagingForwardingButtonNUX.react','MessengerForwardAttachmentDialog.react','React','ReactLayeredComponentMixin','SpotlightViewer','SpotlightViewerBottomBar','SpotlightViewerBottomBarGroup','SpotlightViewerBottomBarLink','SpotlightViewerClose','SpotlightViewport','PageTransitionsRegistrar','PhotoViewerDimensions','XMessagingVideoAttachmentController','Vector','cx','fbt','guid'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,aa,ba,ca){if(c.__markCompiled)c.__markCompiled();var da=o.PropTypes,ea=200,fa=o.createClass({displayName:'MessagingVideoViewer',propTypes:{disableForward:da.bool,pageID:da.number,rootClassName:da.string,videoSize:da.instanceOf(z).isRequired,videoID:da.string.isRequired,videoURI:da.string.isRequired},mixins:[i,p],getInitialState:function(){var ga=new x({verticalPadding:ea});return {dimensions:ga.getStageDimensions(this.props.videoSize),loading:true,open:true,showForward:false};},componentWillMount:function(){this._domID=ca();},componentDidMount:function(){this._loadVideoPlayer();w.registerCompletionCallback((function(){this.close();return true;}).bind(this));},_loadVideoPlayer:function(){var ga=y.getURIBuilder().setString('video_id',this.props.videoID).setString('video_container_id',this._domID).setInt('width',this.state.dimensions.x).setInt('height',this.state.dimensions.y).getURI();if(this.props.pageID)ga=h.create(ga,this.props.pageID);this.request=new j().setMethod('GET').setURI(ga).setReadOnly(true).setHandler((function(ha){return this.setState({loading:false});}).bind(this)).send();},close:function(){if(!this.state.open)return;this.setState({open:false},function(){this.inform('close');});},_showForwardDialog:function(){this.setState({showForward:true});this.refs.forwardNUX.close();},_hideForwardDialog:function(){this.setState({showForward:false});},renderLayers:function(){if(this.props.disableForward)return {};var ga=ba._("Forward in separate messages"),ha=k.messengerdotcom?n:l;return {forwardDialog:o.createElement(ha,{attachmentID:this.props.videoID,onClose:this._hideForwardDialog,shown:this.state.showForward,title:ga}),forwardButtonNUX:o.createElement(m,{contextRef:(function(){return this.refs.forwardButton;}).bind(this),ref:'forwardNUX'},ba._("Send this video to other people in separate messages."))};},render:function(){var ga=o.createElement('div',{className:"rfloat",id:this._domID}),ha;if(!this.props.disableForward)ha=o.createElement(t,{onClick:this._showForwardDialog,ref:'forwardButton'},ba._("Forward"));return (o.createElement(q,{onHide:this.close,open:this.state.open,rootClassName:this.props.rootClassName},o.createElement(v,{active:true,className:"_39hc",media:ga,showLoadingIndicator:this.state.loading,stageDimensions:this.state.dimensions,useWidth:true},o.createElement(u,{onClick:this.close}),o.createElement(r,{className:"stat_elem"},o.createElement(s,null),o.createElement(s,null,ha,o.createElement(t,{href:this.props.videoURI},ba._("Download")))))));}});f.exports=fa;},null);